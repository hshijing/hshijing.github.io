<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>随记</title>
    <url>/2024/04/19/419/</url>
    <content><![CDATA[<h2 id="随记"><a href="#随记" class="headerlink" title="随记"></a>随记</h2><p>今天也是学了一下uniapp来开发微信小程序，给我的感觉是挺简单的，很多东西官方团队都封装的很好,唯一吐槽点 官方文档能不能整理一下，这么优秀的团队文档简直就是一坨</p>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>uniapp</tag>
      </tags>
  </entry>
  <entry>
    <title>css3 3d立体效果</title>
    <url>/2024/04/19/3d%E7%AB%8B%E4%BD%93%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h1 id="css3-3d-立体效果"><a href="#css3-3d-立体效果" class="headerlink" title="css3 3d 立体效果"></a>css3 3d 立体效果</h1><p><strong>HTML</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card one&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card two&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card three&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card four&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card five&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card six&quot;</span>&gt;</span>6<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>CSS</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">2rem</span>;</span><br><span class="line">  <span class="attribute">text-transform</span>: capitalize;</span><br><span class="line">  <span class="attribute">perspective</span>: <span class="number">800px</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">45deg</span>) <span class="built_in">rotateX</span>(-<span class="number">30deg</span>);</span><br><span class="line">  <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span><br><span class="line">  <span class="attribute">animation</span>: rotate <span class="number">10s</span> infinite linear;</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">50%</span> -<span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> rotate &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">0deg</span>) <span class="built_in">rotateX</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">360deg</span>) <span class="built_in">rotateX</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">10rem</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.one</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.two</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(-<span class="number">200px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.three</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#00f</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">90deg</span>) <span class="built_in">translateX</span>(<span class="number">100px</span>) <span class="built_in">translateZ</span>(<span class="number">100px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.four</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ff0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">90deg</span>) <span class="built_in">translateX</span>(<span class="number">100px</span>) <span class="built_in">translateZ</span>(-<span class="number">100px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.five</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0ff</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateX</span>(<span class="number">90deg</span>) <span class="built_in">translateY</span>(-<span class="number">100px</span>) <span class="built_in">translateZ</span>(<span class="number">100px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.six</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0f</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateX</span>(<span class="number">90deg</span>) <span class="built_in">translateY</span>(-<span class="number">100px</span>) <span class="built_in">translateZ</span>(-<span class="number">100px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>2024-04-25记录</title>
    <url>/2024/04/25/425/</url>
    <content><![CDATA[<h1 id="2024-04-25记录"><a href="#2024-04-25记录" class="headerlink" title="2024-04-25记录"></a>2024-04-25记录</h1><p>完成毕业设计,微信小程序的开发。<br>甄选壁纸,已经发布到小程序,不过搜索功能要30块钱。<br>目前已经在github开源:<a href="https://github.com/hshijing/Graduation-project">github</a></p>
]]></content>
      <categories>
        <category>生活点滴</category>
      </categories>
      <tags>
        <tag>记录</tag>
      </tags>
  </entry>
  <entry>
    <title>2024-04-16记录</title>
    <url>/2024/04/16/416/</url>
    <content><![CDATA[<h2 id="博客完成搭建"><a href="#博客完成搭建" class="headerlink" title="博客完成搭建"></a>博客完成搭建</h2><h2 id="英雄联盟酷酷上分"><a href="#英雄联盟酷酷上分" class="headerlink" title="英雄联盟酷酷上分"></a>英雄联盟酷酷上分</h2><h2 id="准备毕设"><a href="#准备毕设" class="headerlink" title="准备毕设"></a>准备毕设</h2><p>那个老头规定的前端毕设还要写开发文档，写就算了还要写数据库字段代表意义，我服了!!!</p>
]]></content>
      <categories>
        <category>生活点滴</category>
      </categories>
      <tags>
        <tag>记录</tag>
      </tags>
  </entry>
  <entry>
    <title>LRU缓存置换</title>
    <url>/2024/04/17/LRU/</url>
    <content><![CDATA[<h1 id="LRU-缓存置换"><a href="#LRU-缓存置换" class="headerlink" title="LRU 缓存置换"></a>LRU 缓存置换</h1><ul>
<li>LRU（Least Recently Used）(最久未使用)缓存置换算法</li>
<li>在限定的空间已存满数据时，再要增加缓存应当先把一个最近未使用的数据置换出去，然后把新的数据插入到缓存中。</li>
</ul>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LRUCache</span> &#123;</span><br><span class="line">  #map;</span><br><span class="line">  #length;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">len</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#length = len;</span><br><span class="line">    <span class="variable language_">this</span>.#map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">has</span>(<span class="params">key</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#map.<span class="title function_">has</span>(key);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//获取缓存-&gt;获取到了就是最新的缓存访问，所以需要添加到队列头部</span></span><br><span class="line">  <span class="title function_">get</span>(<span class="params">key</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="title function_">has</span>(key)) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="variable language_">this</span>.#map.<span class="title function_">get</span>(key);</span><br><span class="line">    <span class="comment">//删除当前key，添加到队列头部</span></span><br><span class="line">    <span class="variable language_">this</span>.#map.<span class="title function_">delete</span>(key);</span><br><span class="line">    <span class="variable language_">this</span>.#map.<span class="title function_">set</span>(key, value);</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//设置缓存</span></span><br><span class="line">  <span class="title function_">set</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">    <span class="comment">//溢出，删除队列尾部</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.#map.<span class="property">size</span> &gt;= <span class="variable language_">this</span>.#length) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.#map.<span class="title function_">delete</span>(<span class="variable language_">this</span>.#map.<span class="title function_">keys</span>().<span class="title function_">next</span>().<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//修改缓存</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">has</span>(key)) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.#map.<span class="title function_">delete</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.#map.<span class="title function_">set</span>(key, value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="keyword">let</span> cache = <span class="keyword">new</span> <span class="title class_">LRUCache</span>(<span class="number">3</span>);</span><br><span class="line">cache.<span class="title function_">set</span>(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);</span><br><span class="line">cache.<span class="title function_">set</span>(<span class="string">&quot;b&quot;</span>, <span class="number">2</span>);</span><br><span class="line">cache.<span class="title function_">set</span>(<span class="string">&quot;c&quot;</span>, <span class="number">3</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cache);</span><br><span class="line"><span class="comment">// 0: &#123;&quot;a&quot; =&gt; 1&#125; 1: &#123;&quot;b&quot; =&gt; 2&#125;2: &#123;&quot;c&quot; =&gt; 3&#125;</span></span><br><span class="line">cache.<span class="title function_">get</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="comment">// 0: &#123;&quot;b&quot; =&gt; 2&#125;1: &#123;&quot;c&quot; =&gt; 3&#125;2: &#123;&quot;a&quot; =&gt; 1&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cache);</span><br><span class="line">cache.<span class="title function_">set</span>(<span class="string">&quot;d&quot;</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">//0: &#123;&quot;c&quot; =&gt; 3&#125;1: &#123;&quot;a&quot; =&gt; 1&#125;2: &#123;&quot;d&quot; =&gt; 4&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cache);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>Mysql基本语法</title>
    <url>/2024/04/17/Mysql/</url>
    <content><![CDATA[<p><strong>knex</strong></p>
<ul>
<li>基于js的查询生成器,允许使用js代码来生成qsl语句<br><em><strong>新建数据库</strong></em><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE `<span class="keyword">user</span>` </span><br></pre></td></tr></table></figure>
<em><strong>设置编码</strong></em><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DEFAULT</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> <span class="string">&#x27;utf8mb4&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><em><strong>新建表</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users(</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT ,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">  age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">  gender <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;性别&#x27;</span>,</span><br><span class="line">  create_time <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span></span><br><span class="line">)COMMENT <span class="string">&#x27;用户表&#x27;</span>; </span><br></pre></td></tr></table></figure>
<ul>
<li>id int类型(INT)  非空校验(NOT NULL ) 主键(PRIMARY KEY) 自增(AUTO_INCREMENT)</li>
<li>TIMESTAMP(时间戳) DEFAULT(默认值)</li>
<li>COMMENT (注释)</li>
</ul>
<p><em><strong>删除表格</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> `users`;</span><br></pre></td></tr></table></figure>

<p><em><strong>重命名表</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">AFTER <span class="keyword">TABLE</span> <span class="string">&#x27;users&#x27;</span> RENAME <span class="string">&#x27;user&#x27;</span></span><br></pre></td></tr></table></figure>
<p><em><strong>给表格添加字段</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `users` <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> `address` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;地址&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><em><strong>删除字段</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `users` <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> `address`;</span><br></pre></td></tr></table></figure>
<p><em><strong>修改字段</strong></em><br> <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `users` MODIFY <span class="keyword">COLUMN</span> `address` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;家庭住址&#x27;</span>;</span><br></pre></td></tr></table></figure></p>
<p><em><strong>查询字段</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查询单个字段</span><br><span class="line"><span class="keyword">SELECT</span> id <span class="keyword">FROM</span> `users`;</span><br><span class="line"></span><br><span class="line">查询多个字段</span><br><span class="line"><span class="keyword">SELECT</span> id,name <span class="keyword">FROM</span> `users`;</span><br><span class="line"></span><br><span class="line">查询所有字段</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users`;</span><br><span class="line"></span><br><span class="line">查询字段并重命名</span><br><span class="line"><span class="keyword">SELECT</span> id <span class="keyword">AS</span> user_id <span class="keyword">FROM</span> `users`;</span><br><span class="line"></span><br><span class="line">排序  <span class="keyword">DESC</span>(降序)  <span class="keyword">ASC</span>(升序) 默认升序</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users` <span class="keyword">ORDER</span> <span class="keyword">BY</span> age <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">限制查询结果(类似于分页) LIMIT <span class="number">2</span> 指定从头开始查询多少条数据</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users` LIMIT <span class="number">2</span>;</span><br><span class="line">  </span><br><span class="line">限制查询结果(类似于分页) LIMIT <span class="number">2</span>,<span class="number">2</span> 指定从第几个开始查询多少条数据</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users` LIMIT <span class="number">2</span>,<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">模糊查询 在gender字段下 模糊搜索 以<span class="string">&#x27;女&#x27;</span>结尾 <span class="operator">%</span> 匹配<span class="number">0</span>个或多个</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users` <span class="keyword">WHERE</span> gender <span class="keyword">LIKE</span> <span class="string">&#x27;%女&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> 逻辑查询 年龄大于<span class="number">18</span> 且性别为女</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `users` <span class="keyword">WHERE</span> age<span class="operator">&gt;</span><span class="number">18</span> <span class="keyword">AND</span> gender<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><em><strong>新增</strong></em><br>新增 INSERT INTO 表名(列名,…) VALUES(值,…) </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users(`name`,`age`,`gender`,`address`) <span class="keyword">VALUES</span>(<span class="string">&#x27;李四&#x27;</span>,<span class="number">30</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;广西&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><em><strong>更新</strong></em><br>更新 UPDATE <code>表名</code> SET  (字段)key-value(值),key-value WHERE 条件</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `users` <span class="keyword">SET</span> name<span class="operator">=</span><span class="string">&#x27;xd&#x27;</span>,age<span class="operator">=</span><span class="number">20</span>,gender<span class="operator">=</span><span class="string">&#x27;man&#x27;</span>,address<span class="operator">=</span><span class="string">&#x27;防城港&#x27;</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><em><strong>删除</strong></em></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- DELETE FROM 表名 WHERE 条件</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `users` <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span></span><br><span class="line"><span class="comment">-- 批量删除  DELETE FROM 表名 WHERE 条件 IN(值1,值2,值3,...)</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `users` <span class="keyword">WHERE</span> id <span class="keyword">IN</span>(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>后端</category>
      </categories>
      <tags>
        <tag>Mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>4.20随记</title>
    <url>/2024/04/20/420/</url>
    <content><![CDATA[<h1 id="4-20随记"><a href="#4-20随记" class="headerlink" title="4.20随记"></a>4.20随记</h1><h2 id="1-今日学习"><a href="#1-今日学习" class="headerlink" title="1. 今日学习"></a>1. 今日学习</h2><p>完成毕业设计，完成数据库设计。搭建小程序开发环境。</p>
<h2 id="2-今日心情"><a href="#2-今日心情" class="headerlink" title="2. 今日心情"></a>2. 今日心情</h2><p>一般</p>
]]></content>
      <categories>
        <category>生活点滴</category>
      </categories>
      <tags>
        <tag>记录</tag>
      </tags>
  </entry>
  <entry>
    <title>视频弹幕功能</title>
    <url>/2024/05/10/barrage/</url>
    <content><![CDATA[<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/videoDanMu.png" alt="png"></p>
<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><ol>
<li>页面结构-&gt;canvas 覆盖在视频上面,弹幕输入框,按钮,弹幕颜色选择器</li>
<li>初始化数据</li>
<li>初始化 canvas</li>
<li>整理数据参数,循环数据根据参数判定是否绘画弹幕</li>
<li>监听进度条进行弹幕绘制复原</li>
<li>点击发送收集信息 push 到源数据</li>
</ol>
<h2 id="实现源码"><a href="#实现源码" class="headerlink" title="实现源码"></a>实现源码</h2><p><strong>html</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>视频弹幕功能<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./Static/index.min.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;video-wrapper&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">class</span>=<span class="string">&quot;canvas&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;./Static/李世民.mp4&quot;</span> <span class="attr">class</span>=<span class="string">&quot;video&quot;</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;tool-box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;text-input&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>发送弹幕<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span> <span class="attr">class</span>=<span class="string">&quot;color-input&quot;</span> <span class="attr">value</span>=<span class="string">&quot;#e66465&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;./index.js&quot;</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>css</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span>,</span><br><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.video-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.video-wrapper</span> <span class="selector-class">.video</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.video-wrapper</span> <span class="selector-class">.canvas</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tool-box</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tool-box</span> <span class="selector-class">.text-input</span>,</span><br><span class="line"><span class="selector-class">.tool-box</span> <span class="selector-class">.btn</span>,</span><br><span class="line"><span class="selector-class">.tool-box</span> <span class="selector-class">.color-input</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tool-box</span> <span class="selector-class">.text-input</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tool-box</span> <span class="selector-class">.btn</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tool-box</span> <span class="selector-class">.btn</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#00a2ff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tool-box</span> <span class="selector-class">.color-input</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>index.js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; barrageData &#125; <span class="keyword">from</span> <span class="string">&quot;./utils/data.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">VideoBarrage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./utils/videoClass.js&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> videoWrapper = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.video&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> canvasWrapper = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.canvas&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> textInput = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.text-input&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> colorInput = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.color-input&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> button = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.btn&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> video;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">init</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  video = <span class="keyword">new</span> <span class="title class_">VideoBarrage</span>(videoWrapper, canvasWrapper, &#123; barrageData &#125;);</span><br><span class="line">  <span class="title function_">eventBind</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//事件绑定</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">eventBind</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  videoWrapper.<span class="title function_">addEventListener</span>(<span class="string">&quot;play&quot;</span>, handleVideoPlay, <span class="literal">false</span>);</span><br><span class="line">  videoWrapper.<span class="title function_">addEventListener</span>(<span class="string">&quot;pause&quot;</span>, handleVideoPause, <span class="literal">false</span>);</span><br><span class="line">  videoWrapper.<span class="title function_">addEventListener</span>(<span class="string">&quot;seeked&quot;</span>, handleVideoSeeked, <span class="literal">false</span>);</span><br><span class="line">  button.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, handleButtonClick, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 视频开始播放事件函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Event</span>&#125; <span class="variable">e</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleVideoPlay</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">  video.<span class="property">paused</span> = <span class="literal">false</span>;</span><br><span class="line">  video.<span class="title function_">render</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 视频暂停播放事件函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleVideoPause</span> = (<span class="params"></span>) =&gt; (video.<span class="property">paused</span> = <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 操作进度条 -&gt;进度条回退保证弹幕再次绘制</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleVideoSeeked</span> = (<span class="params"></span>) =&gt; video.<span class="title function_">reset</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 点击发送按钮收集当前数据push给源数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleButtonClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (textInput.<span class="property">value</span>.<span class="title function_">trim</span>().<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> content = textInput.<span class="property">value</span>;</span><br><span class="line">  <span class="keyword">const</span> color = colorInput.<span class="property">value</span>;</span><br><span class="line">  <span class="keyword">const</span> runTime = videoWrapper.<span class="property">currentTime</span>;</span><br><span class="line">  <span class="comment">//添加数据</span></span><br><span class="line">  video.<span class="title function_">addData</span>(&#123; content, color, runTime &#125;);</span><br><span class="line">  textInput.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">init</span>();</span><br></pre></td></tr></table></figure>

<p><strong>videoClass.js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BoundaryProcessing</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./utils.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BollData</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./BollData.js&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">VideoBarrage</span> &#123;</span><br><span class="line">  <span class="comment">/** 视频dom <span class="doctag">@type</span> &#123;<span class="type">HTMLVideoElement</span>&#125;  */</span></span><br><span class="line">  #videoWap;</span><br><span class="line">  <span class="comment">/** 源数据  <span class="doctag">@type</span> &#123;<span class="type">Array</span>&#125; */</span></span><br><span class="line">  #data;</span><br><span class="line">  <span class="comment">/** canvas dom <span class="doctag">@type</span> &#123;<span class="type">HTMLCanvasElement</span>&#125; */</span></span><br><span class="line">  canvasWap;</span><br><span class="line">  <span class="comment">/** 标识视频的暂停  <span class="doctag">@type</span> &#123;<span class="type">boolean</span>&#125; */</span></span><br><span class="line">  paused;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">video, canvas, options</span>) &#123;</span><br><span class="line">    <span class="comment">//边界处理</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">BoundaryProcessing</span>(video, canvas, options)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#videoWap = video;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvasWap</span> = canvas;</span><br><span class="line">    <span class="variable language_">this</span>.#data = options.<span class="property">barrageData</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initCanvas</span>(options);</span><br><span class="line">  &#125;</span><br><span class="line">  #<span class="title function_">initCanvas</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">//初始化宽高</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvasWap</span>.<span class="property">width</span> = <span class="variable language_">this</span>.#videoWap.<span class="property">offsetWidth</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvasWap</span>.<span class="property">height</span> = <span class="variable language_">this</span>.#videoWap.<span class="property">offsetHeight</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ctx</span> = <span class="variable language_">this</span>.<span class="property">canvasWap</span>.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">    <span class="comment">//标记视频的状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">paused</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//默认值</span></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>, options, &#123;</span><br><span class="line">      <span class="attr">speed</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="attr">runTime</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&quot;#ffffff&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//二次包装弹幕数据</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">barrageBoolData</span> = <span class="variable language_">this</span>.<span class="title function_">createData</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">render</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 格式化包装数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">createData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#data.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="keyword">new</span> <span class="title class_">BollData</span>(item, <span class="variable language_">this</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//清除画布</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">clearRect</span>();</span><br><span class="line">    <span class="comment">//开始绘画</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">drawData</span>();</span><br><span class="line">    <span class="comment">//视频播放才会一直画弹幕</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">paused</span>) &#123;</span><br><span class="line">      <span class="title function_">requestAnimationFrame</span>(<span class="variable language_">this</span>.<span class="property">render</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">drawData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//获取视频当前的播放时间</span></span><br><span class="line">    <span class="keyword">let</span> currTime = <span class="variable language_">this</span>.#videoWap.<span class="property">currentTime</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">barrageBoolData</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//只处理一次弹幕运动与视频播放到指定时间的弹幕</span></span><br><span class="line">      <span class="keyword">if</span> (!item.<span class="property">stop</span> &amp;&amp; currTime &gt;= item.<span class="property">runTime</span>) &#123;</span><br><span class="line">        <span class="comment">//只需要初始化一次数据</span></span><br><span class="line">        <span class="keyword">if</span> (!item.<span class="property">isInit</span>) &#123;</span><br><span class="line">          item.<span class="title function_">init</span>();</span><br><span class="line">          item.<span class="property">isInit</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//弹幕开始运动</span></span><br><span class="line">        item.<span class="property">textX</span> -= item.<span class="property">speed</span>;</span><br><span class="line">        item.<span class="title function_">draw</span>();</span><br><span class="line">        <span class="comment">//弹幕运动到视频最左侧并消失在视频上</span></span><br><span class="line">        <span class="keyword">if</span> (item.<span class="property">textX</span> &lt;= item.<span class="property">width</span> * -<span class="number">1</span>) &#123;</span><br><span class="line">          item.<span class="property">stop</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 清除canvas画布</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">clearRect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ctx</span>.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">canvasWap</span>.<span class="property">width</span>, <span class="variable language_">this</span>.<span class="property">canvasWap</span>.<span class="property">height</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 重置进度条</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">reset</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">clearRect</span>();</span><br><span class="line">    <span class="comment">//视频当前时间</span></span><br><span class="line">    <span class="keyword">let</span> currentTime = <span class="variable language_">this</span>.#videoWap.<span class="property">currentTime</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">barrageBoolData</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//首次绘制</span></span><br><span class="line">      item.<span class="property">stop</span> = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> (currentTime &lt;= item.<span class="property">runTime</span>) &#123;</span><br><span class="line">        item.<span class="property">isInit</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        item.<span class="property">stop</span> = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">addData</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">barrageBoolData</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">BollData</span>(data, <span class="variable language_">this</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>BollData.js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getTextWidth, getTextPosition &#125; <span class="keyword">from</span> <span class="string">&quot;./utils.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">BollData</span> &#123;</span><br><span class="line">  <span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">CanvasRenderingContext2D</span>&#125; */</span></span><br><span class="line">  #ctx;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">item, ctx</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">content</span> = item.<span class="property">content</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">runTime</span> = item.<span class="property">runTime</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">data</span> = item;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_ctx</span> = ctx;</span><br><span class="line">    <span class="variable language_">this</span>.#ctx = ctx.<span class="property">ctx</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isInit</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">stop</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">color</span> ?? <span class="variable language_">this</span>.<span class="property">_ctx</span>.<span class="property">color</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">speed</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">speed</span> ?? <span class="variable language_">this</span>.<span class="property">_ctx</span>.<span class="property">speed</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fontSize</span> = <span class="number">40</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">width</span> = <span class="title function_">getTextWidth</span>(<span class="variable language_">this</span>.<span class="property">content</span>, <span class="variable language_">this</span>.<span class="property">fontSize</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">textX</span> = <span class="title function_">getTextPosition</span>(<span class="variable language_">this</span>.<span class="property">_ctx</span>.<span class="property">canvasWap</span>, <span class="variable language_">this</span>.<span class="property">fontSize</span>)[<span class="number">0</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">textY</span> = <span class="title function_">getTextPosition</span>(<span class="variable language_">this</span>.<span class="property">_ctx</span>.<span class="property">canvasWap</span>, <span class="variable language_">this</span>.<span class="property">fontSize</span>)[<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">draw</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#ctx.<span class="property">font</span> = <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.fontSize&#125;</span>px Arial`</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#ctx.<span class="property">fillStyle</span> = <span class="variable language_">this</span>.<span class="property">color</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#ctx.<span class="title function_">fillText</span>(<span class="variable language_">this</span>.<span class="property">content</span>, <span class="variable language_">this</span>.<span class="property">textX</span>, <span class="variable language_">this</span>.<span class="property">textY</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>好玩的开灯效果</title>
    <url>/2024/05/15/css%E5%A5%BD%E7%8E%A9%E7%9A%84%E5%BC%80%E7%81%AF%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/kaideng.gif"></p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><p><strong>html</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;light&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;base main&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;base bg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>css</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span>,</span><br><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.btn</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">250px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.light</span> <span class="selector-class">.base</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.btn</span><span class="selector-pseudo">:hover</span> + <span class="selector-class">.light</span> &gt; <span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.btn</span><span class="selector-pseudo">:hover</span> + <span class="selector-class">.light</span> &gt; <span class="selector-class">.bg</span> &#123;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">50px</span>);</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">20</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>canvas 截图效果</title>
    <url>/2024/05/03/canvas%E8%A3%81%E5%89%AA/</url>
    <content><![CDATA[<h1 id="canvas-截图效果"><a href="#canvas-截图效果" class="headerlink" title="canvas 截图效果"></a>canvas 截图效果</h1><h2 id="1-初始化-canvas"><a href="#1-初始化-canvas" class="headerlink" title="1. 初始化 canvas"></a>1. 初始化 canvas</h2><h2 id="2-绘制图片"><a href="#2-绘制图片" class="headerlink" title="2. 绘制图片"></a>2. 绘制图片</h2><h2 id="3-绘制蒙层"><a href="#3-绘制蒙层" class="headerlink" title="3. 绘制蒙层"></a>3. 绘制蒙层</h2><h2 id="4-截图的矩形-蒙层上分鼠标移动范围内进行图片截图绘制"><a href="#4-截图的矩形-蒙层上分鼠标移动范围内进行图片截图绘制" class="headerlink" title="4.截图的矩形&#x3D;&gt; 蒙层上分鼠标移动范围内进行图片截图绘制"></a>4.截图的矩形&#x3D;&gt; 蒙层上分鼠标移动范围内进行图片截图绘制</h2><h2 id="5-在鼠标移动时改变矩形-而且修改-源（新的）图像绘制到目标（已有）的图像上-globalCompositeOperation"><a href="#5-在鼠标移动时改变矩形-而且修改-源（新的）图像绘制到目标（已有）的图像上-globalCompositeOperation" class="headerlink" title="5. 在鼠标移动时改变矩形,而且修改 源（新的）图像绘制到目标（已有）的图像上(globalCompositeOperation)"></a>5. 在鼠标移动时改变矩形,而且修改 源（新的）图像绘制到目标（已有）的图像上(globalCompositeOperation)</h2><h2 id="6-获取截图的数据-放入另一个-canvas-中进行呈现"><a href="#6-获取截图的数据-放入另一个-canvas-中进行呈现" class="headerlink" title="6. 获取截图的数据 放入另一个 canvas 中进行呈现"></a>6. 获取截图的数据 放入另一个 canvas 中进行呈现</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">accesskey</span>=<span class="string">&quot;image/*&quot;</span> <span class="attr">class</span>=<span class="string">&quot;inp&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">class</span>=<span class="string">&quot;canvas&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> inp = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box .inp&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cvs = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box .canvas&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> ctx = cvs.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> newCvs = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> newCtx = newCvs.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line"><span class="comment">//存放鼠标按下的坐标</span></span><br><span class="line"><span class="keyword">let</span> initPos = [];</span><br><span class="line"><span class="comment">//存放截图最终的坐标</span></span><br><span class="line"><span class="keyword">let</span> newCanvas = [];</span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">init</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">bindEvent</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//绑定事件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">bindEvent</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  inp.<span class="title function_">addEventListener</span>(<span class="string">&quot;change&quot;</span>, handleFileSelect, <span class="literal">false</span>);</span><br><span class="line">  cvs.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousedown&quot;</span>, handleCvsMousedown, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//初始化canvas并展示图片</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleFileSelect</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> file = e.<span class="property">target</span>.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line">  reader.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    img.<span class="property">src</span> = e.<span class="property">target</span>.<span class="property">result</span>;</span><br><span class="line">    img.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">initCvs</span>();</span><br><span class="line">      <span class="title function_">drawMask</span>(<span class="number">0</span>, <span class="number">0</span>, cvs.<span class="property">width</span>, cvs.<span class="property">height</span>, <span class="number">0.5</span>);</span><br><span class="line">      <span class="keyword">if</span> (newCanvas.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(newCvs);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  reader.<span class="title function_">readAsDataURL</span>(file);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//初始化canvas</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">initCvs</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  cvs.<span class="property">width</span> = <span class="number">700</span>;</span><br><span class="line">  cvs.<span class="property">height</span> = <span class="number">700</span>;</span><br><span class="line">  cvs.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">  ctx.<span class="title function_">drawImage</span>(img, <span class="number">0</span>, <span class="number">0</span>, cvs.<span class="property">width</span>, cvs.<span class="property">height</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制蒙层</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">drawMask</span> = (<span class="params">x, y, wid, hei, opacity</span>) =&gt; &#123;</span><br><span class="line">  ctx.<span class="property">fillStyle</span> = <span class="string">`rgba(0,0,0,<span class="subst">$&#123;opacity&#125;</span>)`</span>;</span><br><span class="line">  ctx.<span class="title function_">fillRect</span>(x, y, wid, hei);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//鼠标移动持续触发裁剪框大小</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleCvsMousedown</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">  initPos = [e.<span class="property">offsetX</span>, e.<span class="property">offsetY</span>];</span><br><span class="line">  cvs.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, handleCvsMousemove, <span class="literal">false</span>);</span><br><span class="line">  cvs.<span class="title function_">addEventListener</span>(<span class="string">&quot;mouseup&quot;</span>, handleCvsMouseup, <span class="literal">false</span>);</span><br><span class="line">  cvs.<span class="title function_">addEventListener</span>(<span class="string">&quot;mouseleave&quot;</span>, handleCvsMouseup, <span class="literal">false</span>);</span><br><span class="line">  cvs.<span class="title function_">addEventListener</span>(<span class="string">&quot;mouseenter&quot;</span>, handleCvsMouseup, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//开始裁剪</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleCvsMousemove</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">offsetX</span>: endX, <span class="attr">offsetY</span>: endY &#125; = e;</span><br><span class="line">  <span class="keyword">const</span> [startX, startY] = initPos;</span><br><span class="line">  <span class="comment">//得到裁剪框的宽高</span></span><br><span class="line">  <span class="keyword">const</span> wid = endX - startX;</span><br><span class="line">  <span class="keyword">const</span> hei = endY - startY;</span><br><span class="line">  <span class="comment">//收集展示裁剪后的图片坐标</span></span><br><span class="line">  newCanvas = [startX, startY, wid, hei];</span><br><span class="line">  <span class="comment">//清除画布</span></span><br><span class="line">  ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, cvs.<span class="property">width</span>, cvs.<span class="property">height</span>);</span><br><span class="line">  <span class="title function_">drawMask</span>(<span class="number">0</span>, <span class="number">0</span>, cvs.<span class="property">width</span>, cvs.<span class="property">height</span>, <span class="number">0.5</span>);</span><br><span class="line">  <span class="comment">//绘制裁剪框</span></span><br><span class="line">  <span class="title function_">drawSelect</span>(cvs.<span class="property">width</span>, cvs.<span class="property">height</span>, wid, hei);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//绘制裁剪框</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">drawSelect</span> = (<span class="params">cvsWid, cvsHei, wid, hei</span>) =&gt; &#123;</span><br><span class="line">  ctx.<span class="property">globalCompositeOperation</span> = <span class="string">&quot;destination-out&quot;</span>;</span><br><span class="line">  ctx.<span class="property">fillStyle</span> = <span class="string">&quot;rgba(0,0,0,1)&quot;</span>;</span><br><span class="line">  ctx.<span class="title function_">fillRect</span>(...initPos, wid, hei);</span><br><span class="line">  ctx.<span class="property">globalCompositeOperation</span> = <span class="string">&quot;destination-over&quot;</span>;</span><br><span class="line">  ctx.<span class="title function_">drawImage</span>(img, <span class="number">0</span>, <span class="number">0</span>, img.<span class="property">width</span>, img.<span class="property">height</span>, <span class="number">0</span>, <span class="number">0</span>, cvsWid, cvsHei);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//完成截图选区，取消对应事件 生成一个新的canvas展示截取后的图片</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleCvsMouseup</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">  cvs.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, handleCvsMousemove, <span class="literal">false</span>);</span><br><span class="line">  cvs.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mouseup&quot;</span>, handleCvsMouseup, <span class="literal">false</span>);</span><br><span class="line">  cvs.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mouseleave&quot;</span>, handleCvsMouseup, <span class="literal">false</span>);</span><br><span class="line">  cvs.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mouseenter&quot;</span>, handleCvsMouseup, <span class="literal">false</span>);</span><br><span class="line">  <span class="title function_">drawNewCvs</span>(newCanvas);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//展示截取的图片</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">drawNewCvs</span> = (<span class="params">newCanvas</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> data = ctx.<span class="title function_">getImageData</span>(...newCanvas);</span><br><span class="line">  newCtx.<span class="title function_">clearRect</span>(...newCanvas);</span><br><span class="line">  newCvs.<span class="property">width</span> = newCanvas[<span class="number">2</span>];</span><br><span class="line">  newCvs.<span class="property">height</span> = newCanvas[<span class="number">3</span>];</span><br><span class="line">  newCtx.<span class="title function_">putImageData</span>(data, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(newCvs);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">init</span>();</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>深入forEach</title>
    <url>/2024/04/16/forEach/</url>
    <content><![CDATA[<h1 id="在使用-forEach-时的一些现象"><a href="#在使用-forEach-时的一些现象" class="headerlink" title="在使用 forEach 时的一些现象"></a>在使用 forEach 时的一些现象</h1><ol>
<li>为什么次添加一个元素到数组不会陷入死循环？</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  arr.<span class="title function_">push</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arr&quot;</span>, item); <span class="comment">//arr 1 arr 2  arr 3</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>为什么下标为 1 的元素没有删除？</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, i</span>) =&gt;</span> &#123;</span><br><span class="line">  arr.<span class="title function_">splice</span>(i, <span class="number">1</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arr&quot;</span>, item); <span class="comment">//arr 1  arr 3</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">//[2]</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>为什么存在稀疏元素时 会跳过稀疏数组？</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [, , <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arr&quot;</span>, item); <span class="comment">//  arr 3</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h1><ol>
<li><p>首先深入了解一下 forEach 的实现(图片引用自<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach">MDN</a><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/forEach.png" alt="forEach"></p>
</li>
<li><p><strong>ecma2023</strong>版 forEach 实现流程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/forEachEcma.png" alt="forEach2023"></p>
</li>
<li><p>forEach 的实现</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">forEach</span> = <span class="keyword">function</span> (<span class="params">callback</span>) &#123;</span><br><span class="line">  <span class="comment">//Let O be ? ToObject(this value)--&gt;this 指向当前的数组</span></span><br><span class="line">  <span class="comment">//  Let len be ? LengthOfArrayLike(O).--&gt; 确定数组的长度</span></span><br><span class="line">  <span class="keyword">const</span> len = <span class="variable language_">this</span>.<span class="property">length</span>;</span><br><span class="line">  <span class="comment">//If IsCallable(callbackfn) is false, throw a TypeError exception-&gt; 判断callback是否为函数</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> callback !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(callback + <span class="string">&quot;is not a function&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//Let k be 0 --&gt; 定义k的初始值 感觉是下标</span></span><br><span class="line">  <span class="keyword">let</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//Repeat, while k &lt; len --&gt;开始迭代</span></span><br><span class="line">  <span class="keyword">while</span> (k &lt; len) &#123;</span><br><span class="line">    <span class="comment">//Let kPresent be ? HasProperty(O, Pk).判断当前下标是否在数组中</span></span><br><span class="line">    <span class="comment">//这里就是跳过稀疏元素的原因</span></span><br><span class="line">    <span class="keyword">if</span> (k <span class="keyword">in</span> <span class="variable language_">this</span>) &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="variable language_">this</span>[k], k, <span class="variable language_">this</span>); <span class="comment">// 执行回调函数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Increase k by 1. --&gt;指向下一个元素</span></span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arr&quot;</span>, item); <span class="comment">//  arr 3</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr); <span class="comment">// [2]</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>为什么元素 2 无法够删除成功？</li>
</ol>
<ul>
<li>第一次执行时，k&#x3D;0，k in this 返回 true，执行 callback，删除下标为 0 的 1，k++，k&#x3D;1,arr&#x3D;[2,3]</li>
<li>第二次执行时，k&#x3D;1，k in this 返回 true，执行 callback，删除下标为 1 的三，k++，k&#x3D;2 arr&#x3D;[2]</li>
<li>第三次执行时，k&#x3D;2,此时数组中已不存在下标为 2 的元素 k in this 返回 false，跳出循环</li>
</ul>
<ol start="5">
<li>为什么不会陷入死循环？</li>
</ol>
<ul>
<li>因为刚开始循环数组时 数组的长度已经确定了</li>
<li>在当前作用域不论你怎么修改数组的长度也无法影响 forEach 的执行</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>promise</title>
    <url>/2024/05/02/promiise/</url>
    <content><![CDATA[<h1 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h1><h2 id="promise-A-规范"><a href="#promise-A-规范" class="headerlink" title="promise A+规范"></a>promise A+规范</h2><ul>
<li><p>Promise 对象的状态: Promise 对象可以处于三种状态之一，分别为 pending（进行中）、fulfilled（已成功）和 rejected（已失败），状态转变只能是从 pending 到 fulfilled 或从 pending 到 rejected。</p>
</li>
<li><p>then 方法: Promise 对象必须提供一个 then 方法，用于处理 Promise 对象的状态变化。then 方法接受两个参数，分别是处理成功情况的回调函数和处理失败情况的回调函数。</p>
</li>
<li><p>then 方法返回一个新的 Promise 对象：then 方法应该返回一个新的 Promise 对象，以便支持 Promise 链式调用。</p>
</li>
<li><p>错误处理: Promise 对象应该能够捕获并处理异常，可以通过 catch 方法或者在 then 方法的失败回调中处理异常。</p>
</li>
<li><p>Promise 对象的值传递: Promise 对象的值可以被传递给后续的 Promise 对象，并且会沿着 Promise 链一直传递下去。</p>
</li>
<li><p>Promise 链: 多个 Promise 对象可以形成 Promise 链，一个 Promise 对象的结果可以作为另一个 Promise 对象的输入。</p>
</li>
</ul>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isMicroQueue &#125; <span class="keyword">from</span> <span class="string">&quot;./isMicroQueue.js&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PENDING</span> = <span class="string">&quot;pending&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FULFILLED</span> = <span class="string">&quot;fulfilled&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">REJECTED</span> = <span class="string">&quot;rejected&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断是否符合promise A+规范</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isPromise</span> = (<span class="params">obj</span>) =&gt;</span><br><span class="line">  !!(obj &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">&quot;object&quot;</span> &amp;&amp; <span class="keyword">typeof</span> obj.<span class="property">then</span> === <span class="string">&quot;function&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyPromise</span> &#123;</span><br><span class="line">  #state = <span class="variable constant_">PENDING</span>;</span><br><span class="line">  #value = <span class="literal">undefined</span>;</span><br><span class="line">  #callbacks = [];</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">executor</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//执行器</span></span><br><span class="line">      <span class="title function_">executor</span>(<span class="variable language_">this</span>.#resolve.<span class="title function_">bind</span>(<span class="variable language_">this</span>), <span class="variable language_">this</span>.#reject.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="comment">//执行环境中遇到错误直接返回失败</span></span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">reject</span>(error);</span><br><span class="line">      <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  #<span class="title function_">resolve</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">changeState</span>(<span class="variable constant_">FULFILLED</span>, value);</span><br><span class="line">  &#125;</span><br><span class="line">  #<span class="title function_">reject</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">changeState</span>(<span class="variable constant_">REJECTED</span>, value);</span><br><span class="line">  &#125;</span><br><span class="line">  #<span class="title function_">changeState</span>(<span class="params">state, value</span>) &#123;</span><br><span class="line">    <span class="comment">//状态只能从pending -&gt; 成功或失败</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.#<span class="title function_">isPending</span>(<span class="variable language_">this</span>.#state)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#state = state;</span><br><span class="line">    <span class="variable language_">this</span>.#value = value;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">runCallbacks</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//收集回调</span></span><br><span class="line">  #<span class="title function_">pushCallback</span>(<span class="params">executor, state, resolve, reject</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#callbacks.<span class="title function_">push</span>(&#123;</span><br><span class="line">      executor,</span><br><span class="line">      state,</span><br><span class="line">      resolve,</span><br><span class="line">      reject,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//执行回调</span></span><br><span class="line">  #<span class="title function_">runCallbacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//未敲定状态</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.#<span class="title function_">isPending</span>(<span class="variable language_">this</span>.#state)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//每次执行一个回调,执行完毕从队列删除</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable language_">this</span>.#callbacks[<span class="number">0</span>]) &#123;</span><br><span class="line">      <span class="keyword">const</span> handler = <span class="variable language_">this</span>.#callbacks[<span class="number">0</span>];</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">runOneCallback</span>(handler);</span><br><span class="line">      <span class="variable language_">this</span>.#callbacks.<span class="title function_">shift</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//判断状态</span></span><br><span class="line">  #<span class="title function_">isPending</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state === <span class="variable constant_">PENDING</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//执行回调</span></span><br><span class="line">  #<span class="title function_">runOneCallback</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="comment">//任务放入微队列执行</span></span><br><span class="line">    <span class="title function_">isMicroQueue</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; executor, state, resolve, reject &#125; = callback;</span><br><span class="line">      <span class="comment">//只处理对应的状态 resolve -&gt;执行then里的第一个参数  reject -&gt;执行then里的第二个参数</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.#state !== state) <span class="keyword">return</span>;</span><br><span class="line">      <span class="comment">//处理then传递参数不是函数的情况</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> executor !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.#state === <span class="variable constant_">FULFILLED</span> ? <span class="title function_">resolve</span>(<span class="variable language_">this</span>.#value) : <span class="title function_">reject</span>(<span class="variable language_">this</span>.#value);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="title function_">executor</span>(<span class="variable language_">this</span>.#value);</span><br><span class="line">        <span class="comment">//保证then返回的promise状态与返回的promise一致</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isPromise</span>(result)) &#123;</span><br><span class="line">          result.<span class="title function_">then</span>(resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">resolve</span>(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="title function_">reject</span>(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">then</span>(<span class="params">onFulfilled, onRejected</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyPromise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//收集对应状态的回调</span></span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">pushCallback</span>(onFulfilled, <span class="variable constant_">FULFILLED</span>, resolve, reject);</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">pushCallback</span>(onRejected, <span class="variable constant_">REJECTED</span>, resolve, reject);</span><br><span class="line">      <span class="variable language_">this</span>.#<span class="title function_">runCallbacks</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//catch方法就是then方法第二个参数的简写</span></span><br><span class="line">  <span class="keyword">catch</span>(onRejected) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">then</span>(<span class="literal">undefined</span>, onRejected);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//finally方法 无论什么状态都会执行</span></span><br><span class="line">  <span class="title function_">finally</span>(<span class="params">onFinally</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">then</span>(</span><br><span class="line">      <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">onFinally</span>();</span><br><span class="line">        <span class="keyword">return</span> val;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">onFinally</span>();</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//静态方法</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">resolve</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="title class_">MyPromise</span>) <span class="keyword">return</span> value;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyPromise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_">isPromise</span>(value)) &#123;</span><br><span class="line">        value.<span class="title function_">then</span>(resolve, reject);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(value);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">reject</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyPromise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">reject</span>(value);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">all</span>(<span class="params">promises</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyPromise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//收集结果</span></span><br><span class="line">        <span class="keyword">const</span> result = [];</span><br><span class="line">        <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> fulfilledCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> promises) &#123;</span><br><span class="line">          <span class="comment">//保证all返回结果的顺序</span></span><br><span class="line">          <span class="keyword">let</span> i = count;</span><br><span class="line">          count++;</span><br><span class="line">          <span class="title class_">MyPromise</span>.<span class="title function_">resolve</span>(item).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">            result[i] = res;</span><br><span class="line">            fulfilledCount++;</span><br><span class="line">            <span class="keyword">if</span> (fulfilledCount === count) &#123;</span><br><span class="line">              <span class="title function_">resolve</span>(result);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, reject);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果传入空数组直接返回成功</span></span><br><span class="line">        <span class="keyword">if</span> (count === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="title function_">resolve</span>(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="title function_">reject</span>(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>scss模块化</title>
    <url>/2024/04/16/scss%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
    <content><![CDATA[<h1 id="scss-模块化"><a href="#scss-模块化" class="headerlink" title="scss 模块化"></a>scss 模块化</h1><ol>
<li>什么是模块化?<br>模块化是指将一个复杂的程序依据一定的规则封装成几个块,并进行组合在一起。</li>
<li>scss 的模块化分为运行时与编译时</li>
</ol>
<ul>
<li>运行时在以往的时候导入方式是使用 import url(‘xxx’)</li>
<li>而编译时的导入方式与运行时大差不差，import ‘xxx’</li>
<li>而这两种方式都差不多，容易混淆，让人无法一眼看出在干什么。</li>
<li>所以 scss 提供了新的导入方式 @use</li>
<li>一个成熟的模块化方式，需要解决变量污染,私有变量等问题</li>
</ul>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">//支持导入别名</span></span><br><span class="line"><span class="keyword">@use</span> <span class="string">&quot;b.scss as a&quot;</span> <span class="keyword">@use</span> <span class="string">&quot;b.scss&quot;</span> // 支持命名空间</span><br><span class="line">  <span class="attribute">color</span>: a.<span class="variable">$color</span>;</span><br><span class="line"><span class="comment">//私有变量</span></span><br><span class="line">$_s: red;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>scss</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack编译</title>
    <url>/2024/04/29/webpack/</url>
    <content><![CDATA[<h1 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h1><h2 id="webpack-编译结果"><a href="#webpack-编译结果" class="headerlink" title="webpack 编译结果"></a>webpack 编译结果</h2><ol>
<li><p>编译结果里 webpack 实现了一套自己的模块化规范,通过把源码中的一个个文件，映射为 key+function 的形式存储到<strong>webpack_modules</strong>中，同时会把源代码里所有的导入导出替换为 webpack_require 以及 exports。加载的时候就是执行对应 key 的函数。</p>
</li>
<li><p><strong>webpack_require</strong>函数:</p>
<ul>
<li>接收一个模块 id,模块 id 是一个文件的行对路径,函数内部会做缓存</li>
<li>缓存里存在对应模块 id 的 exports 对象则直接返回 exports 对象</li>
<li>如果没有则定义一个 exports 对象,然后通过<strong>webpack_require</strong>函数加载模块</li>
</ul>
</li>
<li><p>__unused_webpack_module</p>
<ul>
<li>就是一个对象 做了 get 数据劫持<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">exports</span>: &#123;</span><br><span class="line">   <span class="attr">count</span>:<span class="function">(<span class="params">count</span>) =&gt;</span> &#123;... &#125;</span><br><span class="line">   <span class="attr">default</span>:(...)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>webpack_exports</strong>：</p>
</li>
</ol>
<ul>
<li>就是那个 exports 对象</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 这就是把源码给你运行一遍</span></span><br><span class="line"><span class="comment">   ** __unused_webpack_module-&gt;就是后面定义的exports对象</span></span><br><span class="line"><span class="comment">   ** __webpack_exports__-&gt;也是后面定义的exports对象</span></span><br><span class="line"><span class="comment">   ** __webpack_require__-&gt;就是内部实现的模块化导入函数</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">var</span> __webpack_modules__ = &#123;</span><br><span class="line">    <span class="string">&quot;./src/count.js&quot;</span>: <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">      __unused_webpack_module,</span></span></span><br><span class="line"><span class="params"><span class="function">      __webpack_exports__,</span></span></span><br><span class="line"><span class="params"><span class="function">      __webpack_require__</span></span></span><br><span class="line"><span class="params"><span class="function">    </span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(__webpack_exports__);</span><br><span class="line">      <span class="built_in">eval</span>(</span><br><span class="line">        <span class="string">&quot;__webpack_require__.r(__webpack_exports__);\n __webpack_require__.d(__webpack_exports__, &#123;\n   count: () =&gt; ( count),\n \&quot;default\&quot;: () =&gt; (__WEBPACK_DEFAULT_EXPORT__)\n&#125;);\nconst count = (count) =&gt; &#123;\r\n  return ++count\r\n&#125;\r\nconst key=&#x27;1231231&#x27;\r\n\r\nconst __WEBPACK_DEFAULT_EXPORT__ = (key);\n\n//# sourceURL=webpack://webpack/./src/count.js?&quot;</span></span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;./src/main.js&quot;</span>: <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">      __unused_webpack_module,</span></span></span><br><span class="line"><span class="params"><span class="function">      __webpack_exports__,</span></span></span><br><span class="line"><span class="params"><span class="function">      __webpack_require__</span></span></span><br><span class="line"><span class="params"><span class="function">    </span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">eval</span>(</span><br><span class="line">        <span class="string">&#x27;__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _count__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./count */ &quot;./src/count.js&quot;);\n\r\n\r\nconst log=()=&gt;&#123;\r\n  console.log((0,_count__WEBPACK_IMPORTED_MODULE_0__.count)());\r\n  console.log(_count__WEBPACK_IMPORTED_MODULE_0__[&quot;default&quot;]);\r\n  const div=document.createElement(\&#x27;div\&#x27;);\r\n  div.innerText=(0,_count__WEBPACK_IMPORTED_MODULE_0__.count)();\r\n&#125;\r\nlog()\n\n//# sourceURL=webpack://webpack/./src/main.js?&#x27;</span></span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// 缓存</span></span><br><span class="line">  <span class="keyword">var</span> __webpack_module_cache__ = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 内部实现的模块化导入函数</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">__webpack_require__</span>(<span class="params">moduleId</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(moduleId);</span><br><span class="line">    <span class="comment">// 有缓存直接读并且返回</span></span><br><span class="line">    <span class="keyword">var</span> cachedModule = __webpack_module_cache__[moduleId];</span><br><span class="line">    <span class="keyword">if</span> (cachedModule !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> cachedModule.<span class="property">exports</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 创建一个新的模块并放入缓存</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable language_">module</span> = (__webpack_module_cache__[moduleId] = &#123;</span><br><span class="line">      <span class="attr">exports</span>: &#123;&#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置缓存</span></span><br><span class="line">    __webpack_modules__[moduleId](<span class="variable language_">module</span>, <span class="variable language_">module</span>.<span class="property">exports</span>, __webpack_require__);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 定义getter函数</span></span><br><span class="line">    __webpack_require__.<span class="property">d</span> = <span class="function">(<span class="params"><span class="built_in">exports</span>, definition</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> definition) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          __webpack_require__.<span class="title function_">o</span>(definition, key) &amp;&amp;</span><br><span class="line">          !__webpack_require__.<span class="title function_">o</span>(<span class="built_in">exports</span>, key)</span><br><span class="line">        ) &#123;</span><br><span class="line">          <span class="comment">// 定义属性</span></span><br><span class="line">          <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, key, &#123;</span><br><span class="line">            <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">get</span>: definition[key],</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 判断属性是否存在于此对象上 */</span></span><br><span class="line">  (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    __webpack_require__.<span class="property">o</span> = <span class="function">(<span class="params">obj, prop</span>) =&gt;</span></span><br><span class="line">      <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(obj, prop);</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><br><span class="line">  (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//toStringTag-&gt; 修改对象原型的toString返回结果</span></span><br><span class="line">    <span class="comment">//这也是在保证兼容性,在不支持esm的环境也能运行</span></span><br><span class="line">    __webpack_require__.<span class="property">r</span> = <span class="function">(<span class="params"><span class="built_in">exports</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Symbol</span> !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; <span class="title class_">Symbol</span>.<span class="property">toStringTag</span>) &#123;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, <span class="title class_">Symbol</span>.<span class="property">toStringTag</span>, &#123;</span><br><span class="line">          <span class="attr">value</span>: <span class="string">&quot;Module&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, <span class="string">&quot;__esModule&quot;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;)();</span><br><span class="line">  <span class="keyword">var</span> __webpack_exports__ = <span class="title function_">__webpack_require__</span>(<span class="string">&quot;./src/main.js&quot;</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>工程化</tag>
      </tags>
  </entry>
  <entry>
    <title>scss实现星空特效</title>
    <url>/2024/04/19/scss%E5%AE%9E%E7%8E%B0%E6%98%9F%E7%A9%BA/</url>
    <content><![CDATA[<h1 id="scss实现星空特效"><a href="#scss实现星空特效" class="headerlink" title="scss实现星空特效"></a>scss实现星空特效</h1><h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/xingKong.gif" alt="scss实现星空特效"></p>
<ul>
<li>以前实现这种特效都是用 js 来实现的，现在随着 css 预编译的发展，scss 也可以实现这种效果。</li>
</ul>
<h2 id="实现难点"><a href="#实现难点" class="headerlink" title="实现难点"></a>实现难点</h2><ol>
<li>不同的大小</li>
<li>不同的移动速度</li>
<li>不同的数量</li>
<li>不同透明度</li>
</ol>
<p><strong>html</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>scss<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>scss</strong></p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&quot;Courier New&quot;</span>, Courier, monospace;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.8509803922</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//生成多个阴影</span></span><br><span class="line"><span class="keyword">@function</span> getShadow(<span class="variable">$n</span>) &#123;</span><br><span class="line">  <span class="variable">$shadow</span>: <span class="string">&quot;#&#123;random(100)&#125;vw #&#123;random(100)&#125;vh #fff&quot;</span>;</span><br><span class="line">  <span class="keyword">@for</span> <span class="variable">$i</span> from <span class="number">2</span> through <span class="variable">$n</span> &#123;</span><br><span class="line">    <span class="variable">$shadow</span>: <span class="string">&quot;#&#123;$shadow&#125;, #&#123;random(200)&#125;vw #&#123;random(100)&#125;vh #fff&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">@return</span> unquote(<span class="variable">$shadow</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//无限延Y轴移动</span></span><br><span class="line"><span class="keyword">@keyframes</span> move &#123;</span><br><span class="line">  to &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">100vh</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//动画移动速度</span></span><br><span class="line"><span class="variable">$animation</span>: <span class="number">600s</span>;</span><br><span class="line"><span class="comment">//阴影数量</span></span><br><span class="line"><span class="variable">$count</span>: <span class="number">1000</span>;</span><br><span class="line"><span class="comment">//透明度</span></span><br><span class="line"><span class="variable">$opacity</span>: <span class="number">1</span>;</span><br><span class="line"><span class="keyword">@for</span> <span class="variable">$i</span> from <span class="number">1</span> through <span class="number">5</span> &#123;</span><br><span class="line">  <span class="variable">$animation</span>: <span class="variable">$animation</span>/<span class="number">2</span>;</span><br><span class="line">  <span class="variable">$count</span>: <span class="variable">$count</span>/<span class="number">2</span>;</span><br><span class="line">  <span class="variable">$opacity</span>: <span class="variable">$opacity</span> * <span class="number">0.95</span>;</span><br><span class="line">  <span class="selector-class">.layer</span>#&#123;<span class="variable">$i</span>&#125; &#123;</span><br><span class="line">    <span class="variable">$size</span>: #&#123;<span class="variable">$i</span> * <span class="number">2</span>&#125;px;</span><br><span class="line">    <span class="attribute">animation</span>: move (<span class="variable">$animation</span>) infinite linear;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="variable">$size</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="variable">$size</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="variable">$opacity</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">getShadow</span>(<span class="variable">$count</span>);</span><br><span class="line">    &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">      <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">      <span class="attribute">position</span>: fixed;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">100vh</span>;</span><br><span class="line">      <span class="attribute">width</span>: inherit;</span><br><span class="line">      <span class="attribute">height</span>: inherit;</span><br><span class="line">      <span class="attribute">border-radius</span>: inherit;</span><br><span class="line">      <span class="attribute">box-shadow</span>: inherit;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>编译后的 css</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&quot;Courier New&quot;</span>, Courier, monospace;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.85098</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> move &#123;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">100vh</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer1</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: move <span class="number">300s</span> infinite linear;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.95</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">75vw</span> <span class="number">75vh</span> <span class="number">#fff</span>, <span class="number">42vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">131vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">38vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">55vw</span> <span class="number">83vh</span> <span class="number">#fff</span>, <span class="number">138vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">98vw</span> <span class="number">76vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">93vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">96vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">40vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">20vw</span> <span class="number">45vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">174vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">68vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">131vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">179vw</span> <span class="number">45vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">154vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">104vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">105vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">3vw</span> <span class="number">43vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">6vw</span> <span class="number">71vh</span> <span class="number">#fff</span>, <span class="number">92vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">141vw</span> <span class="number">45vh</span> <span class="number">#fff</span>, <span class="number">27vw</span> <span class="number">89vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">76vw</span> <span class="number">36vh</span> <span class="number">#fff</span>, <span class="number">153vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">13vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">165vw</span> <span class="number">48vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">162vw</span> <span class="number">9vh</span> <span class="number">#fff</span>, <span class="number">43vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">133vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">105vw</span> <span class="number">66vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">121vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">133vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">6vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">47vw</span> <span class="number">49vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">159vw</span> <span class="number">7vh</span> <span class="number">#fff</span>, <span class="number">179vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">175vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">169vw</span> <span class="number">62vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">71vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">26vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">74vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">41vw</span> <span class="number">76vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">5vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">82vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">39vw</span> <span class="number">91vh</span> <span class="number">#fff</span>, <span class="number">42vw</span> <span class="number">96vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">108vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">162vw</span> <span class="number">69vh</span> <span class="number">#fff</span>, <span class="number">44vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">66vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">179vw</span> <span class="number">37vh</span> <span class="number">#fff</span>, <span class="number">144vw</span> <span class="number">76vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">22vw</span> <span class="number">64vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">188vw</span> <span class="number">45vh</span> <span class="number">#fff</span>, <span class="number">120vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">94vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">74vw</span> <span class="number">13vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">77vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">147vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">176vw</span> <span class="number">81vh</span> <span class="number">#fff</span>, <span class="number">121vw</span> <span class="number">87vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">7vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">134vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">155vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">7vw</span> <span class="number">23vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">43vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">186vw</span> <span class="number">22vh</span> <span class="number">#fff</span>, <span class="number">59vw</span> <span class="number">89vh</span> <span class="number">#fff</span>, <span class="number">100vw</span> <span class="number">18vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">138vw</span> <span class="number">90vh</span> <span class="number">#fff</span>, <span class="number">149vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">48vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">191vw</span> <span class="number">10vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">126vw</span> <span class="number">37vh</span> <span class="number">#fff</span>, <span class="number">77vw</span> <span class="number">9vh</span> <span class="number">#fff</span>, <span class="number">128vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">148vw</span> <span class="number">16vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">108vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">72vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">168vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">39vw</span> <span class="number">5vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">8vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">16vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">98vw</span> <span class="number">65vh</span> <span class="number">#fff</span>, <span class="number">68vw</span> <span class="number">1vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">171vw</span> <span class="number">60vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">170vw</span> <span class="number">10vh</span> <span class="number">#fff</span>, <span class="number">9vw</span> <span class="number">52vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">147vw</span> <span class="number">67vh</span> <span class="number">#fff</span>, <span class="number">64vw</span> <span class="number">90vh</span> <span class="number">#fff</span>, <span class="number">42vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">151vw</span> <span class="number">85vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">111vw</span> <span class="number">11vh</span> <span class="number">#fff</span>, <span class="number">150vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">27vw</span> <span class="number">30vh</span> <span class="number">#fff</span>, <span class="number">133vw</span> <span class="number">54vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">66vw</span> <span class="number">61vh</span> <span class="number">#fff</span>, <span class="number">139vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">75vh</span> <span class="number">#fff</span>, <span class="number">85vw</span> <span class="number">72vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">160vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">76vw</span> <span class="number">1vh</span> <span class="number">#fff</span>, <span class="number">112vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">167vw</span> <span class="number">97vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">35vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">16vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">32vw</span> <span class="number">47vh</span> <span class="number">#fff</span>, <span class="number">168vw</span> <span class="number">92vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">57vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">25vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">89vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">57vw</span> <span class="number">90vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">99vw</span> <span class="number">63vh</span> <span class="number">#fff</span>, <span class="number">11vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">114vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">141vw</span> <span class="number">34vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">124vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">62vw</span> <span class="number">11vh</span> <span class="number">#fff</span>, <span class="number">122vw</span> <span class="number">52vh</span> <span class="number">#fff</span>, <span class="number">176vw</span> <span class="number">57vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">142vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">22vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">149vw</span> <span class="number">37vh</span> <span class="number">#fff</span>, <span class="number">17vw</span> <span class="number">57vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">104vw</span> <span class="number">5vh</span> <span class="number">#fff</span>, <span class="number">83vw</span> <span class="number">89vh</span> <span class="number">#fff</span>, <span class="number">44vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">28vw</span> <span class="number">87vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">136vw</span> <span class="number">95vh</span> <span class="number">#fff</span>, <span class="number">24vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">116vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">150vw</span> <span class="number">20vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">154vw</span> <span class="number">58vh</span> <span class="number">#fff</span>, <span class="number">7vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">3vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">119vw</span> <span class="number">33vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">41vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">61vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">30vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">193vw</span> <span class="number">19vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">137vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">199vw</span> <span class="number">61vh</span> <span class="number">#fff</span>, <span class="number">82vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">96vw</span> <span class="number">17vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">57vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">26vw</span> <span class="number">93vh</span> <span class="number">#fff</span>, <span class="number">62vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">145vw</span> <span class="number">75vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">57vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">155vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">67vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">31vw</span> <span class="number">52vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">125vw</span> <span class="number">39vh</span> <span class="number">#fff</span>, <span class="number">121vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">93vw</span> <span class="number">67vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">27vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">195vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">8vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">62vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">62vw</span> <span class="number">88vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">113vw</span> <span class="number">12vh</span> <span class="number">#fff</span>, <span class="number">51vw</span> <span class="number">11vh</span> <span class="number">#fff</span>, <span class="number">196vw</span> <span class="number">90vh</span> <span class="number">#fff</span>, <span class="number">87vw</span> <span class="number">41vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">90vw</span> <span class="number">16vh</span> <span class="number">#fff</span>, <span class="number">20vw</span> <span class="number">37vh</span> <span class="number">#fff</span>, <span class="number">29vw</span> <span class="number">14vh</span> <span class="number">#fff</span>, <span class="number">139vw</span> <span class="number">38vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">124vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">10vw</span> <span class="number">51vh</span> <span class="number">#fff</span>, <span class="number">91vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">28vw</span> <span class="number">12vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">30vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">72vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">191vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">72vw</span> <span class="number">21vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">44vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">126vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">109vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">113vw</span> <span class="number">41vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">64vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">59vw</span> <span class="number">14vh</span> <span class="number">#fff</span>, <span class="number">106vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">65vw</span> <span class="number">50vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">77vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">191vw</span> <span class="number">39vh</span> <span class="number">#fff</span>, <span class="number">70vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">166vw</span> <span class="number">62vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">144vw</span> <span class="number">27vh</span> <span class="number">#fff</span>, <span class="number">153vw</span> <span class="number">3vh</span> <span class="number">#fff</span>, <span class="number">50vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">83vw</span> <span class="number">94vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">75vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">179vw</span> <span class="number">1vh</span> <span class="number">#fff</span>, <span class="number">64vw</span> <span class="number">56vh</span> <span class="number">#fff</span>, <span class="number">25vw</span> <span class="number">24vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">93vw</span> <span class="number">71vh</span> <span class="number">#fff</span>, <span class="number">124vw</span> <span class="number">16vh</span> <span class="number">#fff</span>, <span class="number">176vw</span> <span class="number">74vh</span> <span class="number">#fff</span>, <span class="number">120vw</span> <span class="number">31vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">61vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">174vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">114vw</span> <span class="number">63vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">124vw</span> <span class="number">83vh</span> <span class="number">#fff</span>, <span class="number">163vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">28vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">184vw</span> <span class="number">97vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">189vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">62vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">174vw</span> <span class="number">20vh</span> <span class="number">#fff</span>, <span class="number">173vw</span> <span class="number">70vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">67vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">19vw</span> <span class="number">12vh</span> <span class="number">#fff</span>, <span class="number">20vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">171vw</span> <span class="number">82vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">39vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">127vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">90vw</span> <span class="number">91vh</span> <span class="number">#fff</span>, <span class="number">23vw</span> <span class="number">11vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">112vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">34vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">83vh</span> <span class="number">#fff</span>, <span class="number">95vw</span> <span class="number">95vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">56vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">155vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">68vw</span> <span class="number">47vh</span> <span class="number">#fff</span>, <span class="number">133vw</span> <span class="number">11vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">136vw</span> <span class="number">12vh</span> <span class="number">#fff</span>, <span class="number">53vw</span> <span class="number">47vh</span> <span class="number">#fff</span>, <span class="number">1vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">148vw</span> <span class="number">89vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">183vw</span> <span class="number">74vh</span> <span class="number">#fff</span>, <span class="number">11vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">128vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">71vw</span> <span class="number">29vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">181vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">194vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">182vw</span> <span class="number">22vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">63vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">98vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">181vw</span> <span class="number">27vh</span> <span class="number">#fff</span>, <span class="number">19vw</span> <span class="number">14vh</span> <span class="number">#fff</span>, <span class="number">175vw</span> <span class="number">98vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">14vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">46vw</span> <span class="number">88vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">47vh</span> <span class="number">#fff</span>, <span class="number">141vw</span> <span class="number">23vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">124vw</span> <span class="number">7vh</span> <span class="number">#fff</span>, <span class="number">92vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">85vw</span> <span class="number">58vh</span> <span class="number">#fff</span>, <span class="number">16vw</span> <span class="number">54vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">93vw</span> <span class="number">27vh</span> <span class="number">#fff</span>, <span class="number">119vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">94vw</span> <span class="number">22vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">32vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">190vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">15vh</span> <span class="number">#fff</span>, <span class="number">23vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">190vw</span> <span class="number">84vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">64vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">65vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">84vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">70vw</span> <span class="number">6vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">45vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">4vw</span> <span class="number">30vh</span> <span class="number">#fff</span>, <span class="number">122vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">114vw</span> <span class="number">88vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">104vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">45vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">6vw</span> <span class="number">83vh</span> <span class="number">#fff</span>, <span class="number">22vw</span> <span class="number">48vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">2vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">79vw</span> <span class="number">63vh</span> <span class="number">#fff</span>, <span class="number">92vw</span> <span class="number">18vh</span> <span class="number">#fff</span>, <span class="number">22vw</span> <span class="number">94vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">182vw</span> <span class="number">39vh</span> <span class="number">#fff</span>, <span class="number">192vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">196vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">116vw</span> <span class="number">16vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">16vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">79vw</span> <span class="number">39vh</span> <span class="number">#fff</span>, <span class="number">117vw</span> <span class="number">93vh</span> <span class="number">#fff</span>, <span class="number">32vw</span> <span class="number">27vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">134vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">90vw</span> <span class="number">15vh</span> <span class="number">#fff</span>, <span class="number">193vw</span> <span class="number">65vh</span> <span class="number">#fff</span>, <span class="number">178vw</span> <span class="number">35vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">97vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">40vw</span> <span class="number">88vh</span> <span class="number">#fff</span>, <span class="number">90vw</span> <span class="number">30vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">53vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">186vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">155vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">25vw</span> <span class="number">7vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">106vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">86vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">34vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">109vw</span> <span class="number">75vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">44vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">184vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">26vw</span> <span class="number">73vh</span> <span class="number">#fff</span>, <span class="number">108vw</span> <span class="number">44vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">189vw</span> <span class="number">84vh</span> <span class="number">#fff</span>, <span class="number">121vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">185vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">121vw</span> <span class="number">68vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">137vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">199vw</span> <span class="number">25vh</span> <span class="number">#fff</span>, <span class="number">71vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">140vw</span> <span class="number">15vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">3vw</span> <span class="number">47vh</span> <span class="number">#fff</span>, <span class="number">151vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">143vw</span> <span class="number">11vh</span> <span class="number">#fff</span>, <span class="number">161vw</span> <span class="number">62vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">88vw</span> <span class="number">7vh</span> <span class="number">#fff</span>, <span class="number">37vw</span> <span class="number">8vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">76vh</span> <span class="number">#fff</span>, <span class="number">107vw</span> <span class="number">45vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">160vw</span> <span class="number">61vh</span> <span class="number">#fff</span>, <span class="number">19vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">148vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">176vw</span> <span class="number">18vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">46vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">196vw</span> <span class="number">21vh</span> <span class="number">#fff</span>, <span class="number">164vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">171vw</span> <span class="number">67vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">150vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">46vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">35vw</span> <span class="number">15vh</span> <span class="number">#fff</span>, <span class="number">142vw</span> <span class="number">41vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">148vw</span> <span class="number">22vh</span> <span class="number">#fff</span>, <span class="number">88vw</span> <span class="number">52vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">81vw</span> <span class="number">45vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">172vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">101vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">194vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">38vw</span> <span class="number">73vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">191vw</span> <span class="number">60vh</span> <span class="number">#fff</span>, <span class="number">169vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">92vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">41vw</span> <span class="number">5vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">22vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">154vw</span> <span class="number">18vh</span> <span class="number">#fff</span>, <span class="number">177vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">91vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">67vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">63vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">70vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">37vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">113vw</span> <span class="number">14vh</span> <span class="number">#fff</span>, <span class="number">53vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">127vw</span> <span class="number">95vh</span> <span class="number">#fff</span>, <span class="number">145vw</span> <span class="number">41vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">199vw</span> <span class="number">15vh</span> <span class="number">#fff</span>, <span class="number">169vw</span> <span class="number">52vh</span> <span class="number">#fff</span>, <span class="number">133vw</span> <span class="number">63vh</span> <span class="number">#fff</span>, <span class="number">134vw</span> <span class="number">89vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">42vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">138vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">144vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">112vw</span> <span class="number">81vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">159vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">72vw</span> <span class="number">25vh</span> <span class="number">#fff</span>, <span class="number">145vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">32vw</span> <span class="number">11vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">196vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">45vw</span> <span class="number">7vh</span> <span class="number">#fff</span>, <span class="number">162vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">93vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">60vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">115vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">100vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">146vw</span> <span class="number">16vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">158vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">131vw</span> <span class="number">71vh</span> <span class="number">#fff</span>, <span class="number">165vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">115vw</span> <span class="number">17vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">194vw</span> <span class="number">27vh</span> <span class="number">#fff</span>, <span class="number">12vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">14vw</span> <span class="number">52vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">133vw</span> <span class="number">65vh</span> <span class="number">#fff</span>, <span class="number">182vw</span> <span class="number">43vh</span> <span class="number">#fff</span>, <span class="number">5vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">187vw</span> <span class="number">73vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">81vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">34vw</span> <span class="number">93vh</span> <span class="number">#fff</span>, <span class="number">25vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">117vw</span> <span class="number">50vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">153vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">177vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">195vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">151vw</span> <span class="number">65vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">99vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">191vw</span> <span class="number">47vh</span> <span class="number">#fff</span>, <span class="number">110vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">104vw</span> <span class="number">82vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">146vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">168vw</span> <span class="number">91vh</span> <span class="number">#fff</span>, <span class="number">35vw</span> <span class="number">73vh</span> <span class="number">#fff</span>, <span class="number">150vw</span> <span class="number">43vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">40vw</span> <span class="number">58vh</span> <span class="number">#fff</span>, <span class="number">93vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">65vw</span> <span class="number">81vh</span> <span class="number">#fff</span>, <span class="number">153vw</span> <span class="number">59vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">134vw</span> <span class="number">43vh</span> <span class="number">#fff</span>, <span class="number">102vw</span> <span class="number">43vh</span> <span class="number">#fff</span>, <span class="number">1vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">12vw</span> <span class="number">55vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">42vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">141vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">100vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">196vw</span> <span class="number">12vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">80vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">89vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">157vw</span> <span class="number">67vh</span> <span class="number">#fff</span>, <span class="number">42vw</span> <span class="number">98vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">7vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">157vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">4vw</span> <span class="number">27vh</span> <span class="number">#fff</span>, <span class="number">166vw</span> <span class="number">40vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">64vw</span> <span class="number">3vh</span> <span class="number">#fff</span>, <span class="number">37vw</span> <span class="number">58vh</span> <span class="number">#fff</span>, <span class="number">27vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">34vw</span> <span class="number">60vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">118vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">160vw</span> <span class="number">58vh</span> <span class="number">#fff</span>, <span class="number">127vw</span> <span class="number">43vh</span> <span class="number">#fff</span>, <span class="number">89vw</span> <span class="number">88vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">47vw</span> <span class="number">24vh</span> <span class="number">#fff</span>, <span class="number">90vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">108vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">64vw</span> <span class="number">16vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">70vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">104vw</span> <span class="number">99vh</span> <span class="number">#fff</span>, <span class="number">9vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">104vw</span> <span class="number">20vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">65vw</span> <span class="number">8vh</span> <span class="number">#fff</span>, <span class="number">171vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">200vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">157vw</span> <span class="number">31vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">5vw</span> <span class="number">39vh</span> <span class="number">#fff</span>, <span class="number">142vw</span> <span class="number">48vh</span> <span class="number">#fff</span>, <span class="number">100vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">194vw</span> <span class="number">35vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">187vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">1vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">122vw</span> <span class="number">16vh</span> <span class="number">#fff</span>, <span class="number">193vw</span> <span class="number">2vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">155vw</span> <span class="number">51vh</span> <span class="number">#fff</span>, <span class="number">197vw</span> <span class="number">56vh</span> <span class="number">#fff</span>, <span class="number">196vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">74vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">151vw</span> <span class="number">71vh</span> <span class="number">#fff</span>, <span class="number">65vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">107vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">91vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">55vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">43vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">135vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">39vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">184vw</span> <span class="number">71vh</span> <span class="number">#fff</span>, <span class="number">133vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">45vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">156vw</span> <span class="number">21vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">102vw</span> <span class="number">69vh</span> <span class="number">#fff</span>, <span class="number">20vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">55vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">130vw</span> <span class="number">17vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">30vw</span> <span class="number">12vh</span> <span class="number">#fff</span>, <span class="number">77vw</span> <span class="number">99vh</span> <span class="number">#fff</span>, <span class="number">169vw</span> <span class="number">43vh</span> <span class="number">#fff</span>, <span class="number">102vw</span> <span class="number">22vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">147vw</span> <span class="number">9vh</span> <span class="number">#fff</span>, <span class="number">96vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">145vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">33vw</span> <span class="number">70vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">68vw</span> <span class="number">18vh</span> <span class="number">#fff</span>, <span class="number">16vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">92vw</span> <span class="number">16vh</span> <span class="number">#fff</span>, <span class="number">50vw</span> <span class="number">46vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">66vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">57vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">14vw</span> <span class="number">88vh</span> <span class="number">#fff</span>, <span class="number">45vw</span> <span class="number">11vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">195vw</span> <span class="number">36vh</span> <span class="number">#fff</span>, <span class="number">107vw</span> <span class="number">71vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">27vh</span> <span class="number">#fff</span>, <span class="number">157vw</span> <span class="number">23vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">158vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">183vw</span> <span class="number">3vh</span> <span class="number">#fff</span>, <span class="number">160vw</span> <span class="number">74vh</span> <span class="number">#fff</span>, <span class="number">96vw</span> <span class="number">14vh</span> <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer1</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: inherit;</span><br><span class="line">  <span class="attribute">height</span>: inherit;</span><br><span class="line">  <span class="attribute">border-radius</span>: inherit;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inherit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer2</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: move <span class="number">150s</span> infinite linear;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.9025</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">34vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">151vw</span> <span class="number">56vh</span> <span class="number">#fff</span>, <span class="number">194vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">58vw</span> <span class="number">74vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">72vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">199vw</span> <span class="number">11vh</span> <span class="number">#fff</span>, <span class="number">156vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">137vw</span> <span class="number">63vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">137vw</span> <span class="number">20vh</span> <span class="number">#fff</span>, <span class="number">114vw</span> <span class="number">7vh</span> <span class="number">#fff</span>, <span class="number">178vw</span> <span class="number">74vh</span> <span class="number">#fff</span>, <span class="number">91vw</span> <span class="number">27vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">194vw</span> <span class="number">16vh</span> <span class="number">#fff</span>, <span class="number">123vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">81vw</span> <span class="number">10vh</span> <span class="number">#fff</span>, <span class="number">14vw</span> <span class="number">29vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">91vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">27vw</span> <span class="number">20vh</span> <span class="number">#fff</span>, <span class="number">112vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">68vw</span> <span class="number">5vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">110vw</span> <span class="number">76vh</span> <span class="number">#fff</span>, <span class="number">59vw</span> <span class="number">58vh</span> <span class="number">#fff</span>, <span class="number">200vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">104vw</span> <span class="number">79vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">94vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">128vw</span> <span class="number">7vh</span> <span class="number">#fff</span>, <span class="number">161vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">168vw</span> <span class="number">40vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">51vw</span> <span class="number">24vh</span> <span class="number">#fff</span>, <span class="number">195vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">89vw</span> <span class="number">31vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">57vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">49vw</span> <span class="number">27vh</span> <span class="number">#fff</span>, <span class="number">171vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">188vw</span> <span class="number">80vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">139vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">138vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">103vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">126vw</span> <span class="number">3vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">16vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">174vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">186vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">166vw</span> <span class="number">43vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">90vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">80vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">122vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">190vw</span> <span class="number">1vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">89vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">134vw</span> <span class="number">15vh</span> <span class="number">#fff</span>, <span class="number">165vw</span> <span class="number">74vh</span> <span class="number">#fff</span>, <span class="number">25vw</span> <span class="number">53vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">138vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">161vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">114vw</span> <span class="number">45vh</span> <span class="number">#fff</span>, <span class="number">63vw</span> <span class="number">30vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">100vw</span> <span class="number">47vh</span> <span class="number">#fff</span>, <span class="number">103vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">165vw</span> <span class="number">48vh</span> <span class="number">#fff</span>, <span class="number">181vw</span> <span class="number">96vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">145vw</span> <span class="number">25vh</span> <span class="number">#fff</span>, <span class="number">7vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">7vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">156vw</span> <span class="number">30vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">140vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">132vw</span> <span class="number">58vh</span> <span class="number">#fff</span>, <span class="number">189vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">31vw</span> <span class="number">61vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">96vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">13vw</span> <span class="number">22vh</span> <span class="number">#fff</span>, <span class="number">183vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">154vw</span> <span class="number">63vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">124vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">100vw</span> <span class="number">8vh</span> <span class="number">#fff</span>, <span class="number">69vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">167vw</span> <span class="number">58vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">164vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">35vw</span> <span class="number">83vh</span> <span class="number">#fff</span>, <span class="number">84vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">163vw</span> <span class="number">70vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">146vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">179vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">76vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">23vw</span> <span class="number">98vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">96vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">164vw</span> <span class="number">25vh</span> <span class="number">#fff</span>, <span class="number">195vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">41vw</span> <span class="number">68vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">105vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">157vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">148vw</span> <span class="number">93vh</span> <span class="number">#fff</span>, <span class="number">15vw</span> <span class="number">48vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">32vw</span> <span class="number">61vh</span> <span class="number">#fff</span>, <span class="number">119vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">44vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">30vw</span> <span class="number">31vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">60vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">129vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">74vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">194vw</span> <span class="number">72vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">3vw</span> <span class="number">65vh</span> <span class="number">#fff</span>, <span class="number">122vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">124vw</span> <span class="number">61vh</span> <span class="number">#fff</span>, <span class="number">104vw</span> <span class="number">84vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">20vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">196vw</span> <span class="number">84vh</span> <span class="number">#fff</span>, <span class="number">196vw</span> <span class="number">12vh</span> <span class="number">#fff</span>, <span class="number">156vw</span> <span class="number">41vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">81vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">135vw</span> <span class="number">52vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">37vh</span> <span class="number">#fff</span>, <span class="number">189vw</span> <span class="number">33vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">110vw</span> <span class="number">60vh</span> <span class="number">#fff</span>, <span class="number">48vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">197vw</span> <span class="number">51vh</span> <span class="number">#fff</span>, <span class="number">158vw</span> <span class="number">15vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">186vw</span> <span class="number">99vh</span> <span class="number">#fff</span>, <span class="number">50vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">160vw</span> <span class="number">95vh</span> <span class="number">#fff</span>, <span class="number">92vw</span> <span class="number">72vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">181vw</span> <span class="number">48vh</span> <span class="number">#fff</span>, <span class="number">148vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">126vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">40vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">158vw</span> <span class="number">6vh</span> <span class="number">#fff</span>, <span class="number">84vw</span> <span class="number">91vh</span> <span class="number">#fff</span>, <span class="number">26vw</span> <span class="number">51vh</span> <span class="number">#fff</span>, <span class="number">97vw</span> <span class="number">93vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">111vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">188vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">31vw</span> <span class="number">84vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">50vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">9vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">12vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">33vw</span> <span class="number">42vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">1vw</span> <span class="number">25vh</span> <span class="number">#fff</span>, <span class="number">175vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">150vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">129vw</span> <span class="number">86vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">82vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">99vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">73vw</span> <span class="number">6vh</span> <span class="number">#fff</span>, <span class="number">71vw</span> <span class="number">3vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">102vw</span> <span class="number">52vh</span> <span class="number">#fff</span>, <span class="number">198vw</span> <span class="number">86vh</span> <span class="number">#fff</span>, <span class="number">198vw</span> <span class="number">65vh</span> <span class="number">#fff</span>, <span class="number">99vw</span> <span class="number">94vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">183vw</span> <span class="number">20vh</span> <span class="number">#fff</span>, <span class="number">70vw</span> <span class="number">32vh</span> <span class="number">#fff</span>, <span class="number">194vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">87vw</span> <span class="number">28vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">36vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">64vw</span> <span class="number">48vh</span> <span class="number">#fff</span>, <span class="number">63vw</span> <span class="number">99vh</span> <span class="number">#fff</span>, <span class="number">7vw</span> <span class="number">95vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">163vw</span> <span class="number">6vh</span> <span class="number">#fff</span>, <span class="number">39vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">112vw</span> <span class="number">51vh</span> <span class="number">#fff</span>, <span class="number">77vw</span> <span class="number">75vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">164vw</span> <span class="number">10vh</span> <span class="number">#fff</span>, <span class="number">79vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">32vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">25vw</span> <span class="number">38vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">165vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">69vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">29vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">80vw</span> <span class="number">44vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">180vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">46vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">36vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">59vw</span> <span class="number">93vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">122vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">159vw</span> <span class="number">10vh</span> <span class="number">#fff</span>, <span class="number">55vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">156vw</span> <span class="number">11vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">154vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">110vw</span> <span class="number">37vh</span> <span class="number">#fff</span>, <span class="number">19vw</span> <span class="number">95vh</span> <span class="number">#fff</span>, <span class="number">50vw</span> <span class="number">99vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">121vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">41vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">70vw</span> <span class="number">40vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">24vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">125vw</span> <span class="number">1vh</span> <span class="number">#fff</span>, <span class="number">178vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">1vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">102vw</span> <span class="number">25vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">15vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">35vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">177vw</span> <span class="number">11vh</span> <span class="number">#fff</span>, <span class="number">34vw</span> <span class="number">65vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">26vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">109vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">165vw</span> <span class="number">48vh</span> <span class="number">#fff</span>, <span class="number">108vw</span> <span class="number">30vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">4vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">128vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">58vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">105vw</span> <span class="number">29vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">64vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">105vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">133vw</span> <span class="number">51vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">57vw</span> <span class="number">30vh</span> <span class="number">#fff</span>, <span class="number">178vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">91vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">197vw</span> <span class="number">58vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">13vw</span> <span class="number">21vh</span> <span class="number">#fff</span>, <span class="number">63vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">96vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">169vw</span> <span class="number">78vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">175vw</span> <span class="number">88vh</span> <span class="number">#fff</span>, <span class="number">143vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">94vw</span> <span class="number">99vh</span> <span class="number">#fff</span>, <span class="number">134vw</span> <span class="number">32vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">36vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">111vw</span> <span class="number">71vh</span> <span class="number">#fff</span>, <span class="number">198vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">153vw</span> <span class="number">16vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">125vw</span> <span class="number">31vh</span> <span class="number">#fff</span>, <span class="number">183vw</span> <span class="number">93vh</span> <span class="number">#fff</span>, <span class="number">163vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">192vw</span> <span class="number">40vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">77vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">96vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">197vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">69vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">100vw</span> <span class="number">73vh</span> <span class="number">#fff</span>, <span class="number">171vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">111vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">198vw</span> <span class="number">48vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">183vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">52vw</span> <span class="number">3vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">137vw</span> <span class="number">21vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">62vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">28vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">160vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">193vw</span> <span class="number">63vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">98vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">50vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">164vw</span> <span class="number">25vh</span> <span class="number">#fff</span>, <span class="number">122vw</span> <span class="number">60vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">119vw</span> <span class="number">45vh</span> <span class="number">#fff</span>, <span class="number">165vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">124vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">73vw</span> <span class="number">82vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">176vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">154vw</span> <span class="number">4vh</span> <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer2</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: inherit;</span><br><span class="line">  <span class="attribute">height</span>: inherit;</span><br><span class="line">  <span class="attribute">border-radius</span>: inherit;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inherit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer3</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: move <span class="number">75s</span> infinite linear;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.85737</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">59vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">145vw</span> <span class="number">21vh</span> <span class="number">#fff</span>, <span class="number">84vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">101vw</span> <span class="number">62vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">21vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">24vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">68vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">50vw</span> <span class="number">83vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">175vw</span> <span class="number">5vh</span> <span class="number">#fff</span>, <span class="number">97vw</span> <span class="number">18vh</span> <span class="number">#fff</span>, <span class="number">140vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">19vw</span> <span class="number">60vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">26vw</span> <span class="number">46vh</span> <span class="number">#fff</span>, <span class="number">108vw</span> <span class="number">48vh</span> <span class="number">#fff</span>, <span class="number">71vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">22vw</span> <span class="number">37vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">50vw</span> <span class="number">18vh</span> <span class="number">#fff</span>, <span class="number">181vw</span> <span class="number">65vh</span> <span class="number">#fff</span>, <span class="number">104vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">15vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">35vw</span> <span class="number">76vh</span> <span class="number">#fff</span>, <span class="number">186vw</span> <span class="number">55vh</span> <span class="number">#fff</span>, <span class="number">27vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">59vw</span> <span class="number">8vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">29vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">135vw</span> <span class="number">21vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">34vh</span> <span class="number">#fff</span>, <span class="number">191vw</span> <span class="number">88vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">117vw</span> <span class="number">37vh</span> <span class="number">#fff</span>, <span class="number">195vw</span> <span class="number">69vh</span> <span class="number">#fff</span>, <span class="number">53vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">61vw</span> <span class="number">1vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">76vw</span> <span class="number">64vh</span> <span class="number">#fff</span>, <span class="number">124vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">110vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">148vw</span> <span class="number">14vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">87vw</span> <span class="number">5vh</span> <span class="number">#fff</span>, <span class="number">192vw</span> <span class="number">77vh</span> <span class="number">#fff</span>, <span class="number">3vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">142vw</span> <span class="number">10vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">46vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">114vw</span> <span class="number">10vh</span> <span class="number">#fff</span>, <span class="number">118vw</span> <span class="number">68vh</span> <span class="number">#fff</span>, <span class="number">60vw</span> <span class="number">16vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">114vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">146vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">185vw</span> <span class="number">17vh</span> <span class="number">#fff</span>, <span class="number">162vw</span> <span class="number">65vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">125vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">95vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">84vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">144vw</span> <span class="number">51vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">10vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">167vw</span> <span class="number">67vh</span> <span class="number">#fff</span>, <span class="number">116vw</span> <span class="number">97vh</span> <span class="number">#fff</span>, <span class="number">186vw</span> <span class="number">74vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">114vw</span> <span class="number">60vh</span> <span class="number">#fff</span>, <span class="number">161vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">166vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">45vw</span> <span class="number">9vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">93vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">74vh</span> <span class="number">#fff</span>, <span class="number">150vw</span> <span class="number">45vh</span> <span class="number">#fff</span>, <span class="number">169vw</span> <span class="number">78vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">59vw</span> <span class="number">62vh</span> <span class="number">#fff</span>, <span class="number">69vw</span> <span class="number">72vh</span> <span class="number">#fff</span>, <span class="number">124vw</span> <span class="number">98vh</span> <span class="number">#fff</span>, <span class="number">160vw</span> <span class="number">27vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">67vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">175vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">195vw</span> <span class="number">60vh</span> <span class="number">#fff</span>, <span class="number">71vw</span> <span class="number">52vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">86vw</span> <span class="number">99vh</span> <span class="number">#fff</span>, <span class="number">182vw</span> <span class="number">8vh</span> <span class="number">#fff</span>, <span class="number">189vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">55vw</span> <span class="number">16vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">37vw</span> <span class="number">86vh</span> <span class="number">#fff</span>, <span class="number">98vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">8vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">80vw</span> <span class="number">68vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">132vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">199vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">28vw</span> <span class="number">96vh</span> <span class="number">#fff</span>, <span class="number">69vw</span> <span class="number">98vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">144vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">159vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">52vw</span> <span class="number">79vh</span> <span class="number">#fff</span>, <span class="number">132vw</span> <span class="number">9vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">137vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">159vw</span> <span class="number">18vh</span> <span class="number">#fff</span>, <span class="number">128vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">43vw</span> <span class="number">31vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">178vw</span> <span class="number">22vh</span> <span class="number">#fff</span>, <span class="number">192vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">61vw</span> <span class="number">23vh</span> <span class="number">#fff</span>, <span class="number">177vw</span> <span class="number">39vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">7vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">44vw</span> <span class="number">3vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">86vh</span> <span class="number">#fff</span>, <span class="number">155vw</span> <span class="number">44vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">160vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">188vw</span> <span class="number">15vh</span> <span class="number">#fff</span>, <span class="number">109vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">13vw</span> <span class="number">31vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">118vw</span> <span class="number">25vh</span> <span class="number">#fff</span>, <span class="number">195vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">95vw</span> <span class="number">3vh</span> <span class="number">#fff</span>, <span class="number">176vw</span> <span class="number">91vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">65vw</span> <span class="number">53vh</span> <span class="number">#fff</span>, <span class="number">190vw</span> <span class="number">59vh</span> <span class="number">#fff</span>, <span class="number">141vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">138vw</span> <span class="number">15vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">191vw</span> <span class="number">42vh</span> <span class="number">#fff</span>, <span class="number">105vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">187vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">56vw</span> <span class="number">94vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">53vw</span> <span class="number">33vh</span> <span class="number">#fff</span>, <span class="number">142vw</span> <span class="number">1vh</span> <span class="number">#fff</span>, <span class="number">162vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">43vw</span> <span class="number">10vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">139vw</span> <span class="number">19vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">20vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">71vw</span> <span class="number">34vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">142vw</span> <span class="number">38vh</span> <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer3</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: inherit;</span><br><span class="line">  <span class="attribute">height</span>: inherit;</span><br><span class="line">  <span class="attribute">border-radius</span>: inherit;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inherit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer4</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: move <span class="number">37.5s</span> infinite linear;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.81451</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">51vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">24vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">116vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">140vw</span> <span class="number">36vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">114vw</span> <span class="number">36vh</span> <span class="number">#fff</span>, <span class="number">136vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">45vw</span> <span class="number">85vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">11vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">32vw</span> <span class="number">5vh</span> <span class="number">#fff</span>, <span class="number">32vw</span> <span class="number">82vh</span> <span class="number">#fff</span>, <span class="number">183vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">123vw</span> <span class="number">58vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">150vw</span> <span class="number">99vh</span> <span class="number">#fff</span>, <span class="number">138vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">95vw</span> <span class="number">84vh</span> <span class="number">#fff</span>, <span class="number">92vw</span> <span class="number">76vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">200vw</span> <span class="number">10vh</span> <span class="number">#fff</span>, <span class="number">105vw</span> <span class="number">38vh</span> <span class="number">#fff</span>, <span class="number">81vw</span> <span class="number">81vh</span> <span class="number">#fff</span>, <span class="number">117vw</span> <span class="number">48vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">53vw</span> <span class="number">14vh</span> <span class="number">#fff</span>, <span class="number">79vw</span> <span class="number">13vh</span> <span class="number">#fff</span>, <span class="number">174vw</span> <span class="number">63vh</span> <span class="number">#fff</span>, <span class="number">107vw</span> <span class="number">17vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">11vw</span> <span class="number">14vh</span> <span class="number">#fff</span>, <span class="number">138vw</span> <span class="number">49vh</span> <span class="number">#fff</span>, <span class="number">18vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">39vw</span> <span class="number">14vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">71vw</span> <span class="number">10vh</span> <span class="number">#fff</span>, <span class="number">181vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">86vw</span> <span class="number">4vh</span> <span class="number">#fff</span>, <span class="number">192vw</span> <span class="number">84vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">46vw</span> <span class="number">76vh</span> <span class="number">#fff</span>, <span class="number">197vw</span> <span class="number">54vh</span> <span class="number">#fff</span>, <span class="number">174vw</span> <span class="number">75vh</span> <span class="number">#fff</span>, <span class="number">54vw</span> <span class="number">97vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">101vw</span> <span class="number">75vh</span> <span class="number">#fff</span>, <span class="number">40vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">61vw</span> <span class="number">92vh</span> <span class="number">#fff</span>, <span class="number">117vw</span> <span class="number">2vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">28vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">167vw</span> <span class="number">8vh</span> <span class="number">#fff</span>, <span class="number">128vw</span> <span class="number">16vh</span> <span class="number">#fff</span>, <span class="number">55vw</span> <span class="number">71vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">35vw</span> <span class="number">66vh</span> <span class="number">#fff</span>, <span class="number">191vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">172vw</span> <span class="number">48vh</span> <span class="number">#fff</span>, <span class="number">153vw</span> <span class="number">4vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">68vw</span> <span class="number">100vh</span> <span class="number">#fff</span>, <span class="number">9vw</span> <span class="number">2vh</span> <span class="number">#fff</span>, <span class="number">169vw</span> <span class="number">83vh</span> <span class="number">#fff</span>, <span class="number">97vw</span> <span class="number">3vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">28vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">156vw</span> <span class="number">50vh</span> <span class="number">#fff</span>, <span class="number">87vw</span> <span class="number">78vh</span> <span class="number">#fff</span>, <span class="number">6vw</span> <span class="number">36vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">148vw</span> <span class="number">15vh</span> <span class="number">#fff</span>, <span class="number">138vw</span> <span class="number">67vh</span> <span class="number">#fff</span>, <span class="number">114vw</span> <span class="number">60vh</span> <span class="number">#fff</span>, <span class="number">44vw</span> <span class="number">86vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">6vw</span> <span class="number">41vh</span> <span class="number">#fff</span>, <span class="number">127vw</span> <span class="number">57vh</span> <span class="number">#fff</span>, <span class="number">91vw</span> <span class="number">43vh</span> <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer4</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: inherit;</span><br><span class="line">  <span class="attribute">height</span>: inherit;</span><br><span class="line">  <span class="attribute">border-radius</span>: inherit;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inherit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer5</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: move <span class="number">18.75s</span> infinite linear;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.77378</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">12vw</span> <span class="number">88vh</span> <span class="number">#fff</span>, <span class="number">195vw</span> <span class="number">22vh</span> <span class="number">#fff</span>, <span class="number">105vw</span> <span class="number">28vh</span> <span class="number">#fff</span>, <span class="number">161vw</span> <span class="number">32vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">6vw</span> <span class="number">89vh</span> <span class="number">#fff</span>, <span class="number">89vw</span> <span class="number">30vh</span> <span class="number">#fff</span>, <span class="number">62vw</span> <span class="number">67vh</span> <span class="number">#fff</span>, <span class="number">71vw</span> <span class="number">47vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">191vw</span> <span class="number">87vh</span> <span class="number">#fff</span>, <span class="number">189vw</span> <span class="number">76vh</span> <span class="number">#fff</span>, <span class="number">129vw</span> <span class="number">18vh</span> <span class="number">#fff</span>, <span class="number">156vw</span> <span class="number">15vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">78vw</span> <span class="number">29vh</span> <span class="number">#fff</span>, <span class="number">177vw</span> <span class="number">88vh</span> <span class="number">#fff</span>, <span class="number">37vw</span> <span class="number">36vh</span> <span class="number">#fff</span>, <span class="number">189vw</span> <span class="number">89vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">55vw</span> <span class="number">5vh</span> <span class="number">#fff</span>, <span class="number">74vw</span> <span class="number">65vh</span> <span class="number">#fff</span>, <span class="number">89vw</span> <span class="number">80vh</span> <span class="number">#fff</span>, <span class="number">23vw</span> <span class="number">87vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">91vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">8vw</span> <span class="number">74vh</span> <span class="number">#fff</span>, <span class="number">74vw</span> <span class="number">6vh</span> <span class="number">#fff</span>, <span class="number">74vw</span> <span class="number">35vh</span> <span class="number">#fff</span>, <span class="number">59vw</span> <span class="number">11vh</span> <span class="number">#fff</span>,</span><br><span class="line">    <span class="number">186vw</span> <span class="number">26vh</span> <span class="number">#fff</span>, <span class="number">8vw</span> <span class="number">70vh</span> <span class="number">#fff</span>, <span class="number">3vw</span> <span class="number">44vh</span> <span class="number">#fff</span>, <span class="number">131vw</span> <span class="number">73vh</span> <span class="number">#fff</span>, <span class="number">33vw</span> <span class="number">85vh</span></span><br><span class="line">      <span class="number">#fff</span>, <span class="number">116vw</span> <span class="number">94vh</span> <span class="number">#fff</span>, <span class="number">4vw</span> <span class="number">37vh</span> <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer5</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: inherit;</span><br><span class="line">  <span class="attribute">height</span>: inherit;</span><br><span class="line">  <span class="attribute">border-radius</span>: inherit;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inherit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>scss</tag>
      </tags>
  </entry>
  <entry>
    <title>保护单向数据流</title>
    <url>/2024/05/16/%E4%BF%9D%E6%8A%A4%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/</url>
    <content><![CDATA[<h1 id="什么是单向数据流"><a href="#什么是单向数据流" class="headerlink" title="什么是单向数据流"></a>什么是单向数据流</h1><p>单向数据流是指数据只能在一个方向上流动，即从父组件到子组件。在 Vue.js 中，单向数据流是指数据只能从父组件传递给子组件，而不能从子组件传递给父组件。</p>
<h1 id="为什么需要单向数据流"><a href="#为什么需要单向数据流" class="headerlink" title="为什么需要单向数据流"></a>为什么需要单向数据流</h1><p>单向数据流可以确保数据的流动清晰，易于维护和调试。同时，单向数据流也可以避免子组件意外修改父组件的数据，从而导致数据的不一致。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 这样直接绑定数据是不应该的,会直接修改父组件传递的数据,而造成打破单向数据流,为以后的维护调试埋雷 --&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; v-model=&quot;modelValue.keyWord&quot; /&gt;</span><br><span class="line">&lt;select&gt;</span><br><span class="line">  &lt;option v-for=&quot;item in modelValue.select&quot; :key=&quot;item&quot; :value=&quot;item&quot;&gt;</span><br><span class="line">    &#123;&#123; item &#125;&#125;</span><br><span class="line">  &lt;/option&gt;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">const _ = defineProps(&#123; modelValue: &#123; type: Object, default: () =&gt; &#123;&#125; &#125; &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h1 id="保护单向数据流的方案"><a href="#保护单向数据流的方案" class="headerlink" title="保护单向数据流的方案"></a>保护单向数据流的方案</h1><ul>
<li>为每个数据绑定一个事件，改变触发通知父组件 (每个数据都绑定一个,不是最优解)</li>
<li>为每个数据绑定一个计算属性，get 返回父组件传递的数据,set 就触发自定义事件通知父组件修改了<br>(也不是最优解,每个属性都要绑定一个，和上一个方案差不多，<br>因为计算属性监听的修改是对应的属性直接赋值才会触发 set)<br>比如：data.xxx&#x3D;xxx? 才会触发但是我们修改属性是 data.xxx.value&#x3D;xxx</li>
<li>计算属性结合代理<br><strong>父组件</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;childComp v-model=&quot;data&quot; @updateProps=&quot;handleUpdateProps&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; reactive &#125; from &quot;vue&quot;;</span><br><span class="line">import childComp from &quot;./child.vue&quot;;</span><br><span class="line">const data = reactive(&#123;</span><br><span class="line">  keyWord: &quot;hello&quot;,</span><br><span class="line">  select: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;],</span><br><span class="line">&#125;);</span><br><span class="line">const handleUpdateProps = (obj) =&gt; &#123;</span><br><span class="line">  data.keyWord = obj.keyWord;</span><br><span class="line">  data.select = obj.select;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>子组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; computed &#125; from &quot;vue&quot;;</span><br><span class="line">const _ = defineProps(&#123;</span><br><span class="line">  modelValue: &#123;</span><br><span class="line">    type: Object,</span><br><span class="line">    default: () =&gt; &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//不使用update:modelValue 只是想把变化显示出来</span><br><span class="line">const emit = defineEmits([&quot;updateProps&quot;]);</span><br><span class="line">const model = computed(&#123;</span><br><span class="line">  get() &#123;</span><br><span class="line">    const proxy = new Proxy(_.modelValue, &#123;</span><br><span class="line">      get(tar, val) &#123;</span><br><span class="line">        return Reflect.get(tar, val);</span><br><span class="line">      &#125;,</span><br><span class="line">      set(tar, key, val) &#123;</span><br><span class="line">        emit(&quot;updateProps&quot;, &#123;</span><br><span class="line">          ...tar,</span><br><span class="line">          [key]: val,</span><br><span class="line">        &#125;);</span><br><span class="line">        return true;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    return proxy;</span><br><span class="line">  &#125;,</span><br><span class="line">  set(val) &#123;</span><br><span class="line">    emit(&quot;updateProps&quot;, val);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><strong>函数抽离</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useVModel</span>(<span class="params">props, propName,emit</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> model = <span class="title function_">computed</span>(&#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(props[propName], &#123;</span><br><span class="line">        <span class="title function_">get</span>(<span class="params">tar, val</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(tar, val);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">set</span>(<span class="params">tar, key, val</span>) &#123;</span><br><span class="line">          <span class="title function_">emit</span>(<span class="string">`update:<span class="subst">$&#123;propName&#125;</span>`</span>, &#123;</span><br><span class="line">            ...tar,</span><br><span class="line">            [key]: val,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> proxy;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">set</span>(<span class="params">val</span>) &#123;</span><br><span class="line">      <span class="title function_">emit</span>(<span class="string">&quot;updateProps&quot;</span>, val);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>单例模式</title>
    <url>/2024/05/12/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<p><strong>ts 实现</strong></p>
<ul>
<li>私有变量</li>
<li>私有构造函数 不允许在外部通过 new 创建实例</li>
<li>提供获取实例的方法</li>
</ul>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">  <span class="comment">// 私有变量</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="attr">instance</span>: <span class="title class_">Singleton</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="attr">options</span>: &#123;&#125;;</span><br><span class="line">  <span class="comment">// 私有构造函数</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">constructor</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">options</span> = options;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取实例的方法</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="title function_">getInstance</span>(options): <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">//第二次就不会进入判断</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Singleton</span>.<span class="property">instance</span>) &#123;</span><br><span class="line">      <span class="title class_">Singleton</span>.<span class="property">instance</span> = <span class="keyword">new</span> <span class="title class_">Singleton</span>(options);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Singleton</span>.<span class="property">instance</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//判定是否以及初始化</span></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">isInitialized</span>(): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> !!<span class="title class_">Singleton</span>.<span class="property">instance</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>js 实现</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">  <span class="comment">// instance = undefined;</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;实例化&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// static getInstance(name) &#123;</span></span><br><span class="line">  <span class="comment">//   if (!this.instance) &#123;</span></span><br><span class="line">  <span class="comment">//     this.instance = new Singleton(name);</span></span><br><span class="line">  <span class="comment">//   &#125;</span></span><br><span class="line">  <span class="comment">//   return this.instance;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// getName() &#123;</span></span><br><span class="line">  <span class="comment">//   console.log(this.name);</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const instance1 =Singleton.getInstance(&quot;王五&quot;);</span></span><br><span class="line"><span class="comment">// const instance2 = Singleton.getInstance(&quot;李四&quot;);</span></span><br><span class="line"><span class="comment">// const instance3 = new Singleton(&quot;王五&quot;);</span></span><br><span class="line"><span class="comment">// console.log(&quot;instance1 === instance2:&quot;, instance1 === instance2); //true</span></span><br><span class="line"><span class="comment">// console.log(&quot;instance1 === instance3:&quot;, instance1 === instance3); //false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//无法阻止通过new操作符创建新实例</span></span><br><span class="line"><span class="comment">//那么我就代理这个类，在代理类中判断如果实例已经存在，就返回这个实例，否则创建实例</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CreateSingleton</span>(<span class="params">className</span>) &#123;</span><br><span class="line">  <span class="comment">//用于判定是否为初次实例化</span></span><br><span class="line">  <span class="keyword">let</span> instance = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(className, &#123;</span><br><span class="line">    <span class="title function_">construct</span>(<span class="params">target, args</span>) &#123;</span><br><span class="line">      <span class="comment">//如果实例已经存在，就返回这个实例</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;inside proxy constructor&quot;</span>, instance);</span><br><span class="line">      <span class="keyword">if</span> (!instance) &#123;</span><br><span class="line">        instance = <span class="title class_">Reflect</span>.<span class="title function_">construct</span>(target, args);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//防止套娃,把类的构造函数指向代理类</span></span><br><span class="line">  className.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = proxy;</span><br><span class="line">  <span class="keyword">return</span> proxy;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MySingleton</span> = <span class="keyword">new</span> <span class="title class_">CreateSingleton</span>(<span class="title class_">Singleton</span>);</span><br><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="title class_">MySingleton</span>();</span><br><span class="line"><span class="keyword">const</span> s1 = <span class="keyword">new</span> <span class="title class_">MySingleton</span>();</span><br><span class="line"><span class="comment">//运行时 s is not a constructor</span></span><br><span class="line"><span class="keyword">const</span> s2 = <span class="keyword">new</span> <span class="title function_">s</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s === s1);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>大文件上传</title>
    <url>/2024/04/21/%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<h1 id="大文件切片上传"><a href="#大文件切片上传" class="headerlink" title="大文件切片上传"></a>大文件切片上传</h1><ol>
<li>拿到文件对象</li>
<li>使用线程切割文件</li>
<li>拿到切片数组循环上传</li>
<li>上传完毕后通知后端合并文件</li>
</ol>
<h1 id="后端服务"><a href="#后端服务" class="headerlink" title="后端服务"></a>后端服务</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cors <span class="keyword">from</span> <span class="string">&quot;cors&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> multer <span class="keyword">from</span> <span class="string">&quot;multer&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&quot;express&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;node:fs&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;node:path&quot;</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 大文件上传</span></span><br><span class="line"><span class="comment"> * 1. 客户端切片上传文件(给每个文件打上hash)</span></span><br><span class="line"><span class="comment"> * 2. 服务端接收切片, 切片合并</span></span><br><span class="line"><span class="comment"> * 3. 切片上传失败, 切片重传</span></span><br><span class="line"><span class="comment"> * 4. 切片上传成功, 通知服务端合并切片</span></span><br><span class="line"><span class="comment"> * 5. 合并切片成功, 通知客户端上传完成</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化multer</span></span><br><span class="line"><span class="keyword">const</span> storage = multer.<span class="title function_">diskStorage</span>(&#123;</span><br><span class="line">  <span class="comment">//文件保存路径</span></span><br><span class="line">  <span class="attr">destination</span>: <span class="keyword">function</span> (<span class="params">req, file, cb</span>) &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./test/uploads/&quot;</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//文件重命名</span></span><br><span class="line">  <span class="attr">filename</span>: <span class="keyword">function</span> (<span class="params">req, file, cb</span>) &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="string">&quot;-&quot;</span> + req.<span class="property">body</span>.<span class="property">fileName</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//初始化multer</span></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123; <span class="attr">storage</span>: storage &#125;);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"><span class="comment">//接收客户端上传的切片 chunk要与前端文件对象key一致</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/upload&quot;</span>, upload.<span class="title function_">single</span>(<span class="string">&quot;chunk&quot;</span>), <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">ok</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//合并切片</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/merge&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="comment">//读取切片内容</span></span><br><span class="line">  <span class="keyword">const</span> uploadDir = path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;./test/uploads/&quot;</span>);</span><br><span class="line">  <span class="comment">//读取目录下的文件</span></span><br><span class="line">  <span class="keyword">let</span> dirs = fs.<span class="title function_">readdirSync</span>(uploadDir);</span><br><span class="line">  <span class="comment">//根据时间戳排序</span></span><br><span class="line">  dirs.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="title function_">localeCompare</span>(b, <span class="string">&quot;zh-CN&quot;</span>));</span><br><span class="line">  <span class="comment">//合并目标路径</span></span><br><span class="line">  <span class="keyword">const</span> video = path.<span class="title function_">join</span>(</span><br><span class="line">    __dirname,</span><br><span class="line">    <span class="string">&quot;./test/video&quot;</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;req.query.fileName&#125;</span>.mp4`</span></span><br><span class="line">  );</span><br><span class="line">  <span class="comment">//合并切片</span></span><br><span class="line">  dirs.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//读取文件内容</span></span><br><span class="line">    <span class="keyword">const</span> data = fs.<span class="title function_">readFileSync</span>(path.<span class="title function_">join</span>(uploadDir, item));</span><br><span class="line">    <span class="comment">//写入文件(合并)</span></span><br><span class="line">    fs.<span class="title function_">appendFileSync</span>(video, data);</span><br><span class="line">    <span class="comment">//删除切片文件</span></span><br><span class="line">    fs.<span class="title function_">unlinkSync</span>(path.<span class="title function_">join</span>(uploadDir, item));</span><br><span class="line">  &#125;);</span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">ok</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8080</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;server is running at http://localhost:8080&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="前端实现"><a href="#前端实现" class="headerlink" title="前端实现"></a>前端实现</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>大文件分片<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">class</span>=<span class="string">&quot;input&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./main.js&quot;</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>main.js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; cutFile &#125; <span class="keyword">from</span> <span class="string">&quot;./cutFile.js&quot;</span>;</span><br><span class="line"><span class="comment">//获取文件</span></span><br><span class="line"><span class="keyword">const</span> fileDom = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.input&quot;</span>);</span><br><span class="line"></span><br><span class="line">fileDom.<span class="property">onchange</span> = <span class="keyword">async</span> (e) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> file = e.<span class="property">target</span>.<span class="property">files</span>;</span><br><span class="line">  <span class="keyword">const</span> chunks = <span class="keyword">await</span> <span class="title function_">cutFile</span>(file[<span class="number">0</span>]);</span><br><span class="line">  <span class="keyword">const</span> list = [];</span><br><span class="line">  <span class="comment">//上传分片</span></span><br><span class="line">  chunks.<span class="title function_">forEach</span>(<span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&quot;hash&quot;</span>, chunk.<span class="property">spark</span>);</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&quot;index&quot;</span>, chunk.<span class="property">index</span>);</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&quot;chunk&quot;</span>, chunk.<span class="property">blob</span>);</span><br><span class="line">    <span class="comment">//上传</span></span><br><span class="line">    list.<span class="title function_">push</span>(</span><br><span class="line">      <span class="title function_">fetch</span>(<span class="string">&quot;http://localhost:8080/upload&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">body</span>: formData,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//通知后端合并</span></span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">all</span>(list).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&quot;http://127.0.0.1:8080/merge?fileName=李世民&quot;</span>, &#123;</span><br><span class="line">      <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>cutFile.js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">FILE_SIZE</span> = <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">5</span>; <span class="comment">//文件大小限制</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CUP_NUM</span> = navigator.<span class="property">hardwareConcurrency</span> || <span class="number">4</span>; <span class="comment">//线程数量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">cutFile</span>(<span class="params">file</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> fileCount = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(file.<span class="property">size</span> / <span class="variable constant_">FILE_SIZE</span>); <span class="comment">// 文件分片数量</span></span><br><span class="line">    <span class="keyword">const</span> taskNum = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(fileCount / <span class="variable constant_">CUP_NUM</span>); <span class="comment">//每个线程分配任务数量</span></span><br><span class="line">    <span class="keyword">let</span> doneNum = <span class="number">0</span>; <span class="comment">//完成线程数</span></span><br><span class="line">    <span class="keyword">const</span> result = []; <span class="comment">//存放结果</span></span><br><span class="line">    <span class="comment">//创建一个线程并分配任务</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = <span class="variable constant_">CUP_NUM</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> start = i * taskNum; <span class="comment">//每个线程处理任务数</span></span><br><span class="line">      <span class="keyword">let</span> end = (i + <span class="number">1</span>) * taskNum; <span class="comment">//下一个线程处理任务数</span></span><br><span class="line">      <span class="keyword">if</span> (end &gt; fileCount) end = fileCount;</span><br><span class="line">      <span class="comment">//创建线程</span></span><br><span class="line">      <span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&quot;./worker.js&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;module&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">//给线程传递数据</span></span><br><span class="line">      worker.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">        file,</span><br><span class="line">        fileCount,</span><br><span class="line">        start,</span><br><span class="line">        end,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">//监听线程返回结果</span></span><br><span class="line">      worker.<span class="property">onmessage</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = start, len = end; i &lt; len; i++) &#123;</span><br><span class="line">          result[i] = e.<span class="property">data</span>[i - start];</span><br><span class="line">        &#125;</span><br><span class="line">        worker.<span class="title function_">terminate</span>(); <span class="comment">//销毁线程</span></span><br><span class="line">        doneNum++;</span><br><span class="line">        <span class="comment">//判断是否所有线程执行完毕</span></span><br><span class="line">        doneNum === <span class="variable constant_">CUP_NUM</span> ? <span class="title function_">resolve</span>(result) : <span class="string">&quot;&quot;</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>worker.js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createChunk &#125; <span class="keyword">from</span> <span class="string">&quot;./createChunk.js&quot;</span>;</span><br><span class="line">onmessage = <span class="keyword">async</span> (e) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; file, fileCount, start, end &#125; = e.<span class="property">data</span>;</span><br><span class="line">  <span class="keyword">const</span> proms = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = start, len = end; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> chunk = <span class="keyword">await</span> <span class="title function_">createChunk</span>(file, i, fileCount);</span><br><span class="line">    proms.<span class="title function_">push</span>(chunk);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> chunks = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(proms);</span><br><span class="line">  <span class="title function_">postMessage</span>(chunks);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>createChunk.js</strong><br>由于我使用<strong>spark-md5</strong>来进行唯一标识的时候，浏览器网络控制台无法返回期望信息<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/error.png" alt="error">，也不给我报错，单纯引入这个库都没使用都会返回无法加载。可是我在vue又能用?希望有大佬解答下。所以我使用<strong>随机数</strong>来模拟唯一标识。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建分片</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> file &#123;File&#125; 文件对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> index &#123;number&#125; 当前分片索引</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> chunkSize  &#123;number&#125; 分片大小</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">createChunk</span>(<span class="params">file, index, chunkSize</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> start = index * chunkSize; <span class="comment">//当前分片起始位置</span></span><br><span class="line">    <span class="keyword">const</span> end = start + chunkSize; <span class="comment">//当前分片结束位置</span></span><br><span class="line">    <span class="keyword">const</span> spark = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">1000</span>; <span class="comment">//随机数 标识是否为同一分段</span></span><br><span class="line">    <span class="keyword">const</span> blob = file.<span class="title function_">slice</span>(start, end); <span class="comment">//总分片 服务器需要的字段</span></span><br><span class="line">    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>(); <span class="comment">//文件对象</span></span><br><span class="line">    <span class="comment">//文件完成加载</span></span><br><span class="line">    reader.<span class="property">onload</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(&#123;</span><br><span class="line">        start,</span><br><span class="line">        end,</span><br><span class="line">        index,</span><br><span class="line">        blob,</span><br><span class="line">        spark,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line">    reader.<span class="title function_">readAsArrayBuffer</span>(blob);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>并发</title>
    <url>/2024/04/17/%E5%B9%B6%E5%8F%91/</url>
    <content><![CDATA[<h1 id="什么是并发？"><a href="#什么是并发？" class="headerlink" title="什么是并发？"></a>什么是并发？</h1><ul>
<li>你吃饭吃到一半，电话来了，你一直到吃完了以后才去接，这就说明你不支持并发也不支持<strong>并行</strong>。</li>
<li>你吃饭吃到一半，电话来了，你停了下来接了电话，接完后继续吃饭，这说明你支持<strong>并发</strong>。</li>
<li>你吃饭吃到一半，电话来了，你一边打电话一边吃饭，这说明你支持<strong>并行</strong>。</li>
<li><strong>并发</strong>的关键就是需要能<strong>同时处理多个任务</strong>的能力，这个不一定是同时进行的。并行则关键是要能<strong>同时处理多个任务</strong>二者的关键区别在于是否具备同时性。</li>
</ul>
<h1 id="前端并发数量"><a href="#前端并发数量" class="headerlink" title="前端并发数量"></a>前端并发数量</h1><p>关于并发前端能做的就是控制请求数量，控制请求的频率，控制请求的耗时(个人见解)</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">conCurrent</span>(<span class="params">urls, max = <span class="number">2</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> urlList = urls.<span class="title function_">flat</span>(); <span class="comment">//扁平化数组</span></span><br><span class="line">  <span class="keyword">if</span> (urlList.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>([]);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> result = []; <span class="comment">//存放结果数组</span></span><br><span class="line">    <span class="keyword">let</span> index = <span class="number">0</span>; <span class="comment">//指向下一个url</span></span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span>; <span class="comment">//当前完成上传数</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">run</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> url = urlList[index];</span><br><span class="line">      <span class="keyword">const</span> j = index;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        result[j] = <span class="keyword">await</span> <span class="title function_">axios</span>(url);</span><br><span class="line">        index++;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        result[j] = err;</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span> (count === urlList.<span class="property">length</span>) <span class="title function_">resolve</span>(result);</span><br><span class="line">        <span class="keyword">if</span> (index &lt; urlList.<span class="property">length</span>) <span class="keyword">await</span> <span class="title function_">run</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="title class_">Math</span>.<span class="title function_">min</span>(urlList.<span class="property">length</span>, max); i++) &#123;</span><br><span class="line">      <span class="title function_">run</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">axios</span> = (<span class="params">date</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(date);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>搜索引擎优化</title>
    <url>/2024/04/19/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h1 id="搜索建议优化方案"><a href="#搜索建议优化方案" class="headerlink" title="搜索建议优化方案"></a>搜索建议优化方案</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><ul>
<li>在搜索框中，用户输入关键词后，服务器会根据关键词自动补全，并展示在搜索框下方的下拉列表中，如果用户输入的很快，我们应该每个请求都发吗？请求的顺序是否能与响应的顺序一致？</li>
</ul>
<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ul>
<li>保证用户输入的关键词与服务器返回的关键词顺序一致。</li>
<li>减少请求次数。</li>
</ul>
<h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><ol>
<li><strong>使用防抖</strong></li>
</ol>
<ul>
<li>也就是在一段时间内只发送最后一次请求，一段时间内连续请求会取消上一次的请求。</li>
<li>那如果用户在请求成功发送，服务器还没响应的期间再次发送请求呢？服务器能保证响应的顺序吗？</li>
<li>所以防抖也没解决根源性问题。</li>
</ul>
<ol start="2">
<li><strong>使用节流</strong></li>
</ol>
<ul>
<li>也就是在一段时间内只发送第一次请求，后续请求不在处理。</li>
<li>用户快速输入节流无法处理 。</li>
</ul>
<ol start="3">
<li><strong>优解方案</strong></li>
</ol>
<ul>
<li>在每次请求放送时，取消上一次的请求。<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> search = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#app .search&quot;</span>);</span><br><span class="line"><span class="comment">//创建一个控制器</span></span><br><span class="line"><span class="keyword">let</span> controller;</span><br><span class="line">search.<span class="property">onchange</span> = <span class="keyword">async</span> (e) =&gt; &#123;</span><br><span class="line">  <span class="comment">//取消上一次的请求</span></span><br><span class="line">  controller &amp;&amp; controller.<span class="title function_">abort</span>();</span><br><span class="line">  controller = <span class="keyword">new</span> <span class="title class_">AbortController</span>();</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(</span><br><span class="line">    <span class="string">&quot;http://localhost:3000/search?keyword=&quot;</span> + e.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="comment">//关联控制器</span></span><br><span class="line">      <span class="attr">signal</span>: controller.<span class="property">signal</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>数字转中文</title>
    <url>/2024/04/30/%E6%95%B0%E5%AD%97%E8%BD%AC%E4%B8%AD%E6%96%87/</url>
    <content><![CDATA[<h1 id="数字转中文"><a href="#数字转中文" class="headerlink" title="数字转中文"></a>数字转中文</h1><ol>
<li>数字中文映射表</li>
<li>处理特殊情况,什么时候该读零,什么时候不应该出现零？</li>
<li>单位的拼接</li>
<li>实现的难点就在于处理零的情况</li>
</ol>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 给定一个数字，将其转换为中文表示。例如，将数字123转换为“一百二十三”。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: Huang</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; num 要转换的数字</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125; 转换后的中文表示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">numberToChinese</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> num !== <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;function only accept number type&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 每次提取四位数进行转换</span></span><br><span class="line">  <span class="keyword">const</span> nums = num</span><br><span class="line">    .<span class="title function_">toString</span>()</span><br><span class="line">    .<span class="title function_">replace</span>(<span class="regexp">/(?=(\d&#123;4&#125;)+$)/g</span>, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">    .<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    .<span class="title function_">filter</span>(<span class="title class_">Boolean</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> chineseMap = [<span class="string">&quot;&quot;</span>, <span class="string">&quot;万&quot;</span>, <span class="string">&quot;亿&quot;</span>];</span><br><span class="line">  <span class="keyword">let</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; nums.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="comment">//得到转换结果</span></span><br><span class="line">    <span class="keyword">const</span> chinese = <span class="title function_">conversion</span>(nums[i]);</span><br><span class="line">    <span class="comment">//得到单位</span></span><br><span class="line">    <span class="keyword">const</span> unit = chineseMap[nums.<span class="property">length</span> - i - <span class="number">1</span>];</span><br><span class="line">    <span class="comment">//处理中间连续四位为零的特殊情况</span></span><br><span class="line">    <span class="keyword">if</span> (chinese === <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">      res += <span class="string">&quot;零&quot;</span>;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    res += chinese + unit;</span><br><span class="line">  &#125;</span><br><span class="line">  res = <span class="title function_">handlerZero</span>(res);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 每次转换四位数，将结果拼接起来</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; n 四位数组成的数字</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125; 转换后的中文表示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">conversion</span> = (<span class="params">n</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 数值映射表</span></span><br><span class="line">  <span class="keyword">const</span> chineseMap = [</span><br><span class="line">    <span class="string">&quot;零&quot;</span>,</span><br><span class="line">    <span class="string">&quot;一&quot;</span>,</span><br><span class="line">    <span class="string">&quot;二&quot;</span>,</span><br><span class="line">    <span class="string">&quot;三&quot;</span>,</span><br><span class="line">    <span class="string">&quot;四&quot;</span>,</span><br><span class="line">    <span class="string">&quot;五&quot;</span>,</span><br><span class="line">    <span class="string">&quot;六&quot;</span>,</span><br><span class="line">    <span class="string">&quot;七&quot;</span>,</span><br><span class="line">    <span class="string">&quot;八&quot;</span>,</span><br><span class="line">    <span class="string">&quot;九&quot;</span>,</span><br><span class="line">  ];</span><br><span class="line">  <span class="comment">// 定义中文单位 空串是为了对齐</span></span><br><span class="line">  <span class="keyword">const</span> unit = [<span class="string">&quot;&quot;</span>, <span class="string">&quot;十&quot;</span>, <span class="string">&quot;百&quot;</span>, <span class="string">&quot;千&quot;</span>];</span><br><span class="line">  <span class="keyword">let</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; n.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> digit = chineseMap[n[i]];</span><br><span class="line">    <span class="comment">//获取到单位 </span></span><br><span class="line">    <span class="keyword">let</span> u = unit[n.<span class="property">length</span> - i - <span class="number">1</span>];</span><br><span class="line">    <span class="comment">//处理中间为零的特殊情况 避免出现 一千零零一的情况 -&gt;一千零一</span></span><br><span class="line">    <span class="keyword">if</span> (digit === <span class="string">&quot;零&quot;</span>) &#123;</span><br><span class="line">      u = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    res += digit + u;</span><br><span class="line">  &#125;</span><br><span class="line">  res = <span class="title function_">handlerZero</span>(res);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理连续零的特殊情况与最低位为零的特殊情况</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">str</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handlerZero</span> = (<span class="params">str</span>) =&gt; str.<span class="title function_">replace</span>(<span class="regexp">/零+/g</span>, <span class="string">&quot;零&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/零$/</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">numberToChinese</span>(<span class="number">1200008998</span>));</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>原生实现日期选择器</title>
    <url>/2024/05/06/%E6%97%A5%E6%9C%9F%E9%80%89%E6%8B%A9%E5%99%A8/</url>
    <content><![CDATA[<h1 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/datePrick.gif" alt="日期选择器"></p>
<h1 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h1><ol>
<li>根据年月实时计算出该月有多少天</li>
<li>根据对应的年月日渲染出元素</li>
<li>初始化当前日期-&gt;根据传入的日期在日期列表里找出对应下标,然后根据每个元素的固定高度算出滚动条的 TOP</li>
<li>监听对应元素的滚动条滚动结束事件-&gt;然后根据滚动条的 TOP 算出对应的下标。</li>
<li>根据下标实时更新当前的日期，然后重新渲染出对应的年月日。</li>
<li>在动态设置当前日期时，调用实例成员传入的回调函数并注入当前日期以达到实时返回当前日期的目的</li>
</ol>
<h1 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h1><ul>
<li><strong>html</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scroll&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;target&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mask&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrapper year-wrapper&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scroll-wrapper&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scroll&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;target&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mask&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrapper month-wrapper&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scroll-wrapper&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scroll&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;target&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mask&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrapper day-wrapper&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scroll-wrapper&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>css</strong></li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: row;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">250px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.scroll</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.scroll</span> <span class="selector-class">.target</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.scroll</span> <span class="selector-class">.mask</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(</span><br><span class="line">    <span class="number">180deg</span>,</span><br><span class="line">    white,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>),</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>),</span><br><span class="line">    white</span><br><span class="line">  );</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.scroll</span> <span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">250px</span>;</span><br><span class="line">  <span class="attribute">scroll-snap-type</span>: y mandatory;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.scroll</span> <span class="selector-class">.wrapper</span> <span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">scroll-snap-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">::-webkit-scrollbar &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>js</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DatePicker</span> &#123;</span><br><span class="line">  #yearArr = []; <span class="comment">//支持的年份</span></span><br><span class="line">  #monthArr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]; <span class="comment">//月份</span></span><br><span class="line">  #dayArr = []; <span class="comment">//天数</span></span><br><span class="line">  #currDate = []; <span class="comment">//当前日期</span></span><br><span class="line">  #yearWrapper = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.year-wrapper&quot;</span>);</span><br><span class="line">  #monthWrapper = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.month-wrapper&quot;</span>);</span><br><span class="line">  #dayWrapper = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.day-wrapper&quot;</span>);</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; yearArr 传入支持的年限</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Array&lt;number&gt;(3)</span>&#125; currDate  当前日期【年，月，日】</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">yearArr, currDate</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#yearArr = yearArr;</span><br><span class="line">    <span class="variable language_">this</span>.#currDate = currDate;</span><br><span class="line">    <span class="variable language_">this</span>.#dayArr = <span class="variable language_">this</span>.#<span class="title function_">createDays</span>(currDate);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">render</span>();</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">handleScrolls</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据传入的年月来得到天数</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; year  年</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; month 月</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">Array</span>&#125; 返回当前月的 天数列表</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">createDays</span>(<span class="params">[year, month]</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> days = <span class="keyword">new</span> <span class="title class_">Date</span>(year, month, <span class="number">0</span>).<span class="title function_">getDate</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(&#123; <span class="attr">length</span>: days &#125;, <span class="function">(<span class="params">v, i</span>) =&gt;</span> i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 创建单个元素</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">HTMLElement</span>&#125; 返回创建的元素</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">createItem</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    div.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;item&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> div;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据传入的id选择器与对应数据进行创建html元素片段</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">HTMLElement</span>&#125; wrapper 传入的类选择器</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; arr 传入的数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">createItems</span>(<span class="params">wrapper, arr</span>) &#123;</span><br><span class="line">    <span class="comment">//文档片段</span></span><br><span class="line">    <span class="keyword">const</span> fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>();</span><br><span class="line">    <span class="keyword">const</span> scrollWrapper = wrapper.<span class="title function_">querySelector</span>(<span class="string">&quot;.scroll-wrapper&quot;</span>);</span><br><span class="line">    <span class="comment">//留空的元素</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> div = <span class="variable language_">this</span>.#<span class="title function_">createItem</span>();</span><br><span class="line">      fragment.<span class="title function_">appendChild</span>(div);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = arr.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> div = <span class="variable language_">this</span>.#<span class="title function_">createItem</span>();</span><br><span class="line">      div.<span class="property">innerText</span> = arr[i];</span><br><span class="line">      fragment.<span class="title function_">appendChild</span>(div);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//留空的元素</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> div = <span class="variable language_">this</span>.#<span class="title function_">createItem</span>();</span><br><span class="line">      fragment.<span class="title function_">appendChild</span>(div);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//每次渲染都清空原来的内容</span></span><br><span class="line">    scrollWrapper.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">//插入元素</span></span><br><span class="line">    scrollWrapper.<span class="title function_">appendChild</span>(fragment);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//渲染</span></span><br><span class="line">  #<span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//渲染年份</span></span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">createItems</span>(<span class="variable language_">this</span>.#yearWrapper, <span class="variable language_">this</span>.#yearArr);</span><br><span class="line">    <span class="comment">//渲染月份</span></span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">createItems</span>(<span class="variable language_">this</span>.#monthWrapper, <span class="variable language_">this</span>.#monthArr);</span><br><span class="line">    <span class="comment">//渲染天数</span></span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">createItems</span>(<span class="variable language_">this</span>.#dayWrapper, <span class="variable language_">this</span>.#dayArr);</span><br><span class="line">    <span class="comment">//初始化当前日期</span></span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initCurrDates</span>(<span class="variable language_">this</span>.#currDate);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 初始化当前日期</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; currDate  当前日期</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">initCurrDates</span>(<span class="params">currDate</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [year, month, day] = currDate;</span><br><span class="line">    <span class="comment">//初始化单个日期</span></span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initCurrDate</span>(<span class="variable language_">this</span>.#yearArr, year, <span class="variable language_">this</span>.#yearWrapper);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initCurrDate</span>(<span class="variable language_">this</span>.#monthArr, month, <span class="variable language_">this</span>.#monthWrapper);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">initCurrDate</span>(<span class="variable language_">this</span>.#dayArr, day, <span class="variable language_">this</span>.#dayWrapper);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 初始化当前的单个日期</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; arr 当前时间的数组</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; currDate  当前日期</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">HTMLElement</span>&#125; wrapper 当前的类选择器</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">initCurrDate</span>(<span class="params">arr, currDate, wrapper</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> index = arr.<span class="title function_">indexOf</span>(currDate);</span><br><span class="line">    wrapper.<span class="property">scrollTop</span> = index * <span class="number">50</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 监听三个滚动条的结束滚动事件</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">handleScrolls</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">handleScroll</span>(<span class="variable language_">this</span>.#yearWrapper, <span class="string">&quot;year&quot;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">handleScroll</span>(<span class="variable language_">this</span>.#monthWrapper, <span class="string">&quot;month&quot;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">handleScroll</span>(<span class="variable language_">this</span>.#dayWrapper, <span class="string">&quot;day&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 监听单个滚动条的结束滚动事件</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">HTMLElement</span>&#125; domId  当前监听的类选择器</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">string </span>&#125; fileId  当前监听的类型</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">handleScroll</span>(<span class="params">domId, fileId</span>) &#123;</span><br><span class="line">    domId.<span class="title function_">addEventListener</span>(</span><br><span class="line">      <span class="string">&quot;scrollend&quot;</span>,</span><br><span class="line">      <span class="variable language_">this</span>.#setCurrDate.<span class="title function_">bind</span>(<span class="variable language_">this</span>, domId, fileId)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 设置当前显示的日期</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">HTMLElement</span>&#125; dom  当前需要设置日期的类选择器</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; fileId 标识当前需要设置日期的类型</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">setCurrDate</span>(<span class="params">dom, fileId</span>) &#123;</span><br><span class="line">    <span class="comment">//根据滚动条的位置来得到当前的日期在日期列表的下标</span></span><br><span class="line">    <span class="keyword">const</span> index = dom.<span class="property">scrollTop</span> / <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">switch</span> (fileId) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;year&quot;</span>:</span><br><span class="line">        <span class="comment">//设置当前的年份</span></span><br><span class="line">        <span class="variable language_">this</span>.#currDate[<span class="number">0</span>] = <span class="variable language_">this</span>.#yearArr[index];</span><br><span class="line">        <span class="comment">//设置当前的月份日</span></span><br><span class="line">        <span class="variable language_">this</span>.#<span class="title function_">setDayData</span>(<span class="variable language_">this</span>.#currDate);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;month&quot;</span>:</span><br><span class="line">        <span class="variable language_">this</span>.#currDate[<span class="number">1</span>] = <span class="variable language_">this</span>.#monthArr[index];</span><br><span class="line">        <span class="variable language_">this</span>.#<span class="title function_">setDayData</span>(<span class="variable language_">this</span>.#currDate);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;day&quot;</span>:</span><br><span class="line">        <span class="variable language_">this</span>.#currDate[<span class="number">2</span>] = <span class="variable language_">this</span>.#dayArr[index];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;setCurrDateError&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//当前年份变化时,执行实例成员传入的回调函数并注入当前日期</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">callback</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">callback</span>(<span class="variable language_">this</span>.#currDate);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据传入的年月来得到天数</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; year 当前的年</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; month 当前的月</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  #<span class="title function_">setDayData</span>(<span class="params">currDate</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#dayArr = <span class="variable language_">this</span>.#<span class="title function_">createDays</span>(currDate);</span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">createItems</span>(<span class="variable language_">this</span>.#dayWrapper, <span class="variable language_">this</span>.#dayArr);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 获取当前日期</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> &#123;<span class="type">Array</span>&#125; 返回当前的日期</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">getCurrDate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#currDate;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 监听日期的变化实时返回日期</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; callback  回调函数</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">watch</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="keyword">typeof</span> callback === <span class="string">&quot;function&quot;</span> &amp;&amp; (<span class="variable language_">this</span>.<span class="property">callback</span> = callback);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> dateArr = [</span><br><span class="line">  <span class="number">2010</span>, <span class="number">2011</span>, <span class="number">2012</span>, <span class="number">2013</span>, <span class="number">2014</span>, <span class="number">2015</span>, <span class="number">2016</span>, <span class="number">2017</span>, <span class="number">2018</span>, <span class="number">2019</span>, <span class="number">2020</span>, <span class="number">2021</span>, <span class="number">2022</span>,</span><br><span class="line">  <span class="number">2023</span>, <span class="number">2024</span>,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> currDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  .<span class="title function_">toLocaleDateString</span>()</span><br><span class="line">  .<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function">(<span class="params">i</span>) =&gt;</span> <span class="title class_">Number</span>(i));</span><br><span class="line"><span class="keyword">const</span> d = <span class="keyword">new</span> <span class="title class_">DatePicker</span>(dateArr, currDate);</span><br><span class="line">d.<span class="title function_">watch</span>(<span class="function">(<span class="params">date</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;watch&quot;</span>, date);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>红绿灯</title>
    <url>/2024/05/12/%E7%BA%A2%E7%BB%BF%E7%81%AF/</url>
    <content><![CDATA[<h1 id="红绿灯"><a href="#红绿灯" class="headerlink" title="红绿灯"></a>红绿灯</h1><ul>
<li>红绿灯的实现,第一想法就是用 setTimeout 和 setInterval ,但是严格一点来说 setTimeout 一定准时吗？随着时间的推移以及浏览器的渲染流程与优化策略,误差会越来越大.</li>
<li>所以应该使用轮询的方式来做</li>
</ul>
<p><strong>html</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>红绿灯<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;line-count&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;yellow&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gene&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;toolbar__item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>css</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">800px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.line-count</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.line-count</span><span class="selector-class">.active-red</span> &gt; <span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.line-count</span><span class="selector-class">.active-green</span> &gt; <span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">3</span>, <span class="number">248</span>, <span class="number">36</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.line-count</span><span class="selector-class">.active-yellow</span> &gt; <span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">238</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.red</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">146</span>, <span class="number">146</span>, <span class="number">146</span>);</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.gene</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">146</span>, <span class="number">146</span>, <span class="number">146</span>);</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.yellow</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">146</span>, <span class="number">146</span>, <span class="number">146</span>);</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.toolbar__item</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> parent = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box .line-count&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> time = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box .toolbar__item&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> colorLight = [</span><br><span class="line">  &#123; <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>, <span class="attr">time</span>: <span class="number">4</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">color</span>: <span class="string">&quot;yellow&quot;</span>, <span class="attr">time</span>: <span class="number">3</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">color</span>: <span class="string">&quot;green&quot;</span>, <span class="attr">time</span>: <span class="number">6</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">color</span>: <span class="string">&quot;yellow&quot;</span>, <span class="attr">time</span>: <span class="number">3</span> &#125;,</span><br><span class="line">];</span><br><span class="line"><span class="comment">//当前灯的下标</span></span><br><span class="line"><span class="keyword">let</span> currentIndex = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//当前灯的持续时间</span></span><br><span class="line"><span class="keyword">let</span> currentTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line"><span class="comment">//整个灯循环的时间</span></span><br><span class="line"><span class="keyword">let</span> allTime = colorLight.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> pre + cur.<span class="property">time</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentLight</span>(<span class="params">lightArr</span>) &#123;</span><br><span class="line">  <span class="comment">// update核心就是更改下标和灯的持续时间</span></span><br><span class="line">  <span class="title function_">update</span>(lightArr);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">color</span>: <span class="title function_">currentLight</span>(lightArr).<span class="property">color</span>,</span><br><span class="line">    <span class="attr">remain</span>: <span class="title function_">currentLight</span>(lightArr).<span class="property">time</span> - <span class="title function_">activeLight</span>(currentTime),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//获得当前灯的信息</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">currentLight</span> = (<span class="params">arr</span>) =&gt; arr[currentIndex];</span><br><span class="line"><span class="comment">//当前灯持续的时间(秒) 也就是当前时间戳-创建时的时间戳</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">activeLight</span> = (<span class="params"></span>) =&gt; (<span class="title class_">Date</span>.<span class="title function_">now</span>() - currentTime) / <span class="number">1000</span>;</span><br><span class="line"><span class="comment">//更新当前时间 核心逻辑</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">update</span> = (<span class="params">arr</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">//获得当前持续的时间</span></span><br><span class="line">  <span class="keyword">let</span> disTime = <span class="title function_">activeLight</span>();</span><br><span class="line">  <span class="comment">//记录时间轴并更新当前循环时间 保证超过最大时间后重置</span></span><br><span class="line">  disTime = disTime % allTime;</span><br><span class="line">  currentTime += allTime * <span class="title class_">Math</span>.<span class="title function_">floor</span>(disTime / allTime) * <span class="number">1000</span>;</span><br><span class="line">  <span class="comment">//更新当前时间并映射为对应灯</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="comment">//修正时间 也就是让disTime减去灯的持续时间来判断当前应该是什么灯</span></span><br><span class="line">    disTime -= <span class="title function_">currentLight</span>(arr, currentIndex).<span class="property">time</span>;</span><br><span class="line">    <span class="comment">//disTime小于0就表示当前灯还未到切换时间</span></span><br><span class="line">    <span class="keyword">if</span> (disTime &lt; <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//更新当前灯</span></span><br><span class="line">    currentTime += <span class="title function_">currentLight</span>(arr, currentIndex).<span class="property">time</span> * <span class="number">1000</span>;</span><br><span class="line">    currentIndex = (currentIndex + <span class="number">1</span>) % arr.<span class="property">length</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">__update</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> current = <span class="title function_">getCurrentLight</span>(colorLight);</span><br><span class="line">  parent.<span class="property">className</span> = <span class="string">`line-count active-<span class="subst">$&#123;current.color&#125;</span>`</span>;</span><br><span class="line">  time.<span class="property">textContent</span> = <span class="title class_">Math</span>.<span class="title function_">floor</span>(current.<span class="property">remain</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">__update</span>();</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">__update</span>();</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>洋葱模型</title>
    <url>/2024/05/11/%E6%B4%8B%E8%91%B1%E6%A8%A1%E5%9E%8B/</url>
    <content><![CDATA[<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TaskPro</span> &#123;</span><br><span class="line">  #tasks = [];</span><br><span class="line">  #isRun = <span class="literal">false</span>;</span><br><span class="line">  #currIndex = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 添加任务</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">task</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">addTask</span>(<span class="params">task</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#tasks.<span class="title function_">push</span>(task);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//执行任务</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">run</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//不允许连续调用,需要等待上一次实例调用结束</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.#isRun) <span class="keyword">return</span>;</span><br><span class="line">    <span class="variable language_">this</span>.#isRun = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.#<span class="title function_">runTask</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//取出一个任务执行</span></span><br><span class="line">  <span class="keyword">async</span> #<span class="title function_">runTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//边界处理</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.#<span class="title function_">runTaskBoundary</span>()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">const</span> task = <span class="variable language_">this</span>.#tasks[<span class="variable language_">this</span>.#currIndex];</span><br><span class="line">    <span class="comment">//记录当前下标用于判定是否调用next</span></span><br><span class="line">    <span class="keyword">const</span> i = <span class="variable language_">this</span>.#currIndex;</span><br><span class="line">    <span class="comment">// 注入next</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">task</span>(<span class="variable language_">this</span>.<span class="property">next</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">    <span class="keyword">const</span> j = <span class="variable language_">this</span>.#currIndex;</span><br><span class="line">    <span class="comment">//如果没调next 则需要手动调用</span></span><br><span class="line">    <span class="keyword">if</span> (i === j) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">next</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//执行任务时边界处理</span></span><br><span class="line">  #<span class="title function_">runTaskBoundary</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.#currIndex &gt;= <span class="variable language_">this</span>.#tasks.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.#isRun = <span class="literal">false</span>;</span><br><span class="line">      <span class="variable language_">this</span>.#currIndex = <span class="number">0</span>;</span><br><span class="line">      <span class="variable language_">this</span>.#tasks = [];</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">next</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#currIndex++;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.#<span class="title function_">runTask</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> t = <span class="keyword">new</span> <span class="title class_">TaskPro</span>();</span><br><span class="line"></span><br><span class="line">t.<span class="title function_">addTask</span>(<span class="keyword">async</span> (next) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;task1 start&quot;</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">next</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;task1 end&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">t.<span class="title function_">addTask</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;task2&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">t.<span class="title function_">addTask</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;task3&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">t.<span class="title function_">run</span>(); <span class="comment">//输出 task1 start    task2   task3    task1 end</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>scss实现网格布局动画</title>
    <url>/2024/04/26/%E7%BD%91%E6%A0%BC%E5%B8%83%E5%B1%80%E5%8A%A8%E7%94%BB/</url>
    <content><![CDATA[<h1 id="scss-实现网格布局动画"><a href="#scss-实现网格布局动画" class="headerlink" title="scss 实现网格布局动画"></a>scss 实现网格布局动画</h1><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/Wangge.gif" alt="Wangge"></p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><ul>
<li>其实就是找到鼠标进入的元素,根据父元素的:has 伪类选择器选择到该元素,动态修改父元素的 grid-template-columns 和 grid-template-rows 属性<br><strong>html</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./index.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>scss</strong></p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@for</span> <span class="variable">$i</span> from <span class="number">0</span> through <span class="number">8</span> &#123;</span><br><span class="line">  <span class="comment">//为每个item设置背景颜色</span></span><br><span class="line">  <span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(#&#123;$i + <span class="number">1</span>&#125;) &#123;</span><br><span class="line">    <span class="comment">//hsl 色相环</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">hsl</span>(<span class="variable">$i</span> * <span class="number">30%</span>, <span class="number">90%</span>, <span class="number">60%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//选择到父元素动态修改子元素的大小</span></span><br><span class="line">  <span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(.item:nth-child(#&#123;$i + <span class="number">1</span>&#125;)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">    <span class="variable">$r</span>: <span class="built_in">floor</span>(<span class="variable">$i</span>/<span class="number">3</span> + <span class="number">1</span>); <span class="comment">//1-3 行</span></span><br><span class="line">    <span class="variable">$c</span>: <span class="variable">$i</span>%<span class="number">3</span> + <span class="number">1</span>; <span class="comment">//1-3 列</span></span><br><span class="line">    <span class="variable">$arr</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr; <span class="comment">//默认大小</span></span><br><span class="line">    <span class="comment">//改动元素大小 set-nth(目标数组,下标,新值) 是scss函数 动态修改数组元素</span></span><br><span class="line">    <span class="variable">$rows</span>: <span class="built_in">set-nth</span>(<span class="variable">$arr</span>, <span class="variable">$r</span>, <span class="number">2</span>fr);</span><br><span class="line">    <span class="variable">$cols</span>: <span class="built_in">set-nth</span>(<span class="variable">$arr</span>, <span class="variable">$c</span>, <span class="number">2</span>fr);</span><br><span class="line">    <span class="comment">//设置行和列大小</span></span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="variable">$cols</span>;</span><br><span class="line">    <span class="attribute">grid-template-rows</span>: <span class="variable">$rows</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>编译后的 css</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f53d3d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">2</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">2</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f5993d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">2</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">2</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f5f53d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">2</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">2</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#99f53d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">2</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">2</span>fr <span class="number">1</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">5</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#3df53d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">5</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">2</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">2</span>fr <span class="number">1</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">6</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#3df599</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">6</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">2</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">2</span>fr <span class="number">1</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">7</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#3df5f5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">7</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">2</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">2</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">8</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#3d99f5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">8</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">2</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">2</span>fr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">9</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#3d3df5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:has</span>(<span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">9</span>)<span class="selector-pseudo">:hover</span>) &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">2</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">2</span>fr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>scss</tag>
      </tags>
  </entry>
  <entry>
    <title>音乐可视化</title>
    <url>/2024/04/27/%E9%9F%B3%E4%B9%90%E5%8F%AF%E8%A7%86%E5%8C%96/</url>
    <content><![CDATA[<h1 id="音乐可视化"><a href="#音乐可视化" class="headerlink" title="音乐可视化"></a>音乐可视化</h1><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../img/0odzd-o7vnt.gif" alt="音乐可视化"></p>
<span id="more"></span>

<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><ol>
<li>获取音频数据</li>
<li>canvas 绘制</li>
<li>音频数据变化，canvas 变化<br><strong>html</strong></li>
</ol>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;shortcut icon&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;./thumb-1920-548850 (2).jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;image/x-icon&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#363535</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">canvas</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">audio</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">bottom</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">right</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">50%</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#363535</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">canvas</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;./喜欢你-G.E.M.邓紫棋.320.mp3&quot;</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>js</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> canvas = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> audio = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;audio&quot;</span>);</span><br><span class="line"><span class="comment">//初始化画布尺寸</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">initCanvas</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// devicePixelRatio 返回当前显示设备的物理像素分辨率与CSS 像素分辨率之比</span></span><br><span class="line">  <span class="keyword">const</span> size = <span class="number">600</span>;</span><br><span class="line">  canvas.<span class="property">width</span> = size * devicePixelRatio;</span><br><span class="line">  canvas.<span class="property">height</span> = size * devicePixelRatio;</span><br><span class="line">  canvas.<span class="property">style</span>.<span class="property">width</span> = canvas.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;size&#125;</span>px`</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">initCanvas</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据音频数据绘制频谱图</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; data 音频数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; maxVal 最大频域值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">draw</span>(<span class="params">data, maxVal</span>) &#123;</span><br><span class="line">  <span class="comment">//频谱图半径</span></span><br><span class="line">  <span class="keyword">const</span> r = canvas.<span class="property">width</span> / <span class="number">4</span> + <span class="number">20</span> * devicePixelRatio;</span><br><span class="line">  <span class="comment">//中心点</span></span><br><span class="line">  <span class="keyword">const</span> center = canvas.<span class="property">width</span> / <span class="number">2</span>;</span><br><span class="line">  <span class="comment">//清除画布</span></span><br><span class="line">  ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, canvas.<span class="property">height</span>);</span><br><span class="line">  <span class="comment">//计算频域值与频谱图颜色的映射关系</span></span><br><span class="line">  <span class="keyword">const</span> hslStep = <span class="number">360</span> / (data.<span class="property">length</span> - <span class="number">1</span>);</span><br><span class="line">  <span class="comment">//频谱图最大长度</span></span><br><span class="line">  <span class="keyword">const</span> maxLen = canvas.<span class="property">width</span> / <span class="number">2</span> - r;</span><br><span class="line">  <span class="comment">//频谱图最小长度</span></span><br><span class="line">  <span class="keyword">const</span> minLen = <span class="number">2</span> * devicePixelRatio;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">    <span class="comment">//计算当前频域值所对应的频谱图长度</span></span><br><span class="line">    <span class="keyword">const</span> len = <span class="title class_">Math</span>.<span class="title function_">max</span>((data[i] / maxVal) * maxLen, minLen);</span><br><span class="line">    <span class="comment">//计算当前频域值所对应的频谱图颜色</span></span><br><span class="line">    <span class="keyword">const</span> rotate = hslStep * i;</span><br><span class="line">    <span class="comment">//随机颜色</span></span><br><span class="line">    ctx.<span class="property">strokeStyle</span> = <span class="string">`hsl(<span class="subst">$&#123;rotate&#125;</span>deg,65%,65%)`</span>;</span><br><span class="line">    ctx.<span class="property">lineWidth</span> = minLen;</span><br><span class="line">    <span class="keyword">const</span> rad = (rotate * <span class="title class_">Math</span>.<span class="property">PI</span>) / <span class="number">180</span>;</span><br><span class="line">    <span class="comment">//计算频谱图的起始点</span></span><br><span class="line">    <span class="keyword">const</span> startX = center + <span class="title class_">Math</span>.<span class="title function_">cos</span>(rad) * r;</span><br><span class="line">    <span class="keyword">const</span> startY = center + <span class="title class_">Math</span>.<span class="title function_">sin</span>(rad) * r;</span><br><span class="line">    <span class="keyword">const</span> endX = center + <span class="title class_">Math</span>.<span class="title function_">cos</span>(rad) * (r + len);</span><br><span class="line">    <span class="keyword">const</span> endY = center + <span class="title class_">Math</span>.<span class="title function_">sin</span>(rad) * (r + len);</span><br><span class="line">    ctx.<span class="title function_">moveTo</span>(startX, startY);</span><br><span class="line">    ctx.<span class="title function_">lineTo</span>(endX, endY);</span><br><span class="line">    ctx.<span class="title function_">stroke</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化画布</span></span><br><span class="line"><span class="title function_">draw</span>(<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">256</span>).<span class="title function_">fill</span>(<span class="number">0</span>), <span class="number">255</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//标记上下文的创建</span></span><br><span class="line"><span class="keyword">let</span> isInit = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">//音频分析器节点</span></span><br><span class="line"><span class="keyword">let</span> analyser;</span><br><span class="line"><span class="comment">//用于接收分析结果</span></span><br><span class="line"><span class="keyword">let</span> buffer;</span><br><span class="line"></span><br><span class="line">audio.<span class="property">onplay</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//音频上下文只需要创建一次</span></span><br><span class="line">  <span class="keyword">if</span> (isInit) <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">//创建音频上下文</span></span><br><span class="line">  <span class="title function_">createAudio</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createAudio</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">//创建音频上下文</span></span><br><span class="line">  <span class="keyword">const</span> audioCtx = <span class="keyword">new</span> <span class="title class_">AudioContext</span>();</span><br><span class="line">  <span class="comment">//创建音频源节点</span></span><br><span class="line">  <span class="keyword">const</span> source = audioCtx.<span class="title function_">createMediaElementSource</span>(audio);</span><br><span class="line">  <span class="comment">//分析器节点</span></span><br><span class="line">  analyser = audioCtx.<span class="title function_">createAnalyser</span>();</span><br><span class="line">  <span class="comment">//频域数据分析的采样率</span></span><br><span class="line">  analyser.<span class="property">fftSize</span> = <span class="number">256</span>;</span><br><span class="line">  <span class="comment">// buffer的长度为fftSize/2 -&gt;无符号的8位类型化数组</span></span><br><span class="line">  buffer = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(analyser.<span class="property">frequencyBinCount</span>);</span><br><span class="line">  <span class="comment">//连接音频源节点</span></span><br><span class="line">  source.<span class="title function_">connect</span>(analyser);</span><br><span class="line">  <span class="comment">//连接音频输出节点 也就是链接到输出设备</span></span><br><span class="line">  source.<span class="title function_">connect</span>(audioCtx.<span class="property">destination</span>);</span><br><span class="line">  isInit = <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">update</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">requestAnimationFrame</span>(update);</span><br><span class="line">  <span class="comment">//获取频域数据</span></span><br><span class="line">  analyser.<span class="title function_">getByteFrequencyData</span>(buffer);</span><br><span class="line">  <span class="comment">//处理频域数据 让其更加的平滑</span></span><br><span class="line">  <span class="keyword">const</span> offset = <span class="title class_">Math</span>.<span class="title function_">floor</span>((buffer.<span class="property">length</span> * <span class="number">2</span>) / <span class="number">3</span>);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">new</span> <span class="title class_">Array</span>(offset * <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; offset; i++) &#123;</span><br><span class="line">    <span class="comment">//对称的赋值方式，前半部分和后半部分的数据在变换时具有一定的连续性和平滑性</span></span><br><span class="line">    data[i] = data[data.<span class="property">length</span> - <span class="number">1</span> - i] = buffer[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//绘制频谱图</span></span><br><span class="line">  <span class="title function_">draw</span>(data, <span class="number">255</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">update</span>();</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
</search>
